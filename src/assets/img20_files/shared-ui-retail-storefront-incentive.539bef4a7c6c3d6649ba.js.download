/*@license For license information please refer to shared-ui-retail-storefront-incentive.licenses.txt*/
(self.__LOADABLE_LOADED_CHUNKS__=self.__LOADABLE_LOADED_CHUNKS__||[]).push([[286],{29831:function(e,n,t){t.d(n,{I:function(){return L}});var i=t(96540),a=t(25859),r=t(53735),l=t(28667),m=t(8983),o=t(23211),d=t(26143),s=t(28155),c=t(62152),u=t(85911),k=t(39366),v=t(1023),g=t(22913),y=t(93065),p=t(22828),N=t(96912),f=t(65113);const S=e=>{const n={};return e.filter(e=>{if("FragmentDefinition"!==e.kind)return!0;const t=e.name.value;return!n[t]&&(n[t]=!0,!0)})};var F={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"HomeClickstreamAnalyticsFragment"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"HomeClickstreamAnalytics"}},directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"eventName"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"eventVersion"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"payload"},arguments:[],directives:[]}]}}],loc:{start:0,end:122,source:{body:"\n  fragment HomeClickstreamAnalyticsFragment on HomeClickstreamAnalytics {\n    eventName\n    eventVersion\n    payload\n  }\n",name:"GraphQL request",locationOffset:{line:1,column:1}}}},D=e=>{const{eventName:n,eventVersion:t,payload:i}=e||{};if(!n||!t||!i)return null;return{clientPayload:{event:{event_name:n,event_version:t}},serverPayload:i}},C=({element:e,children:n})=>{var t,a;if("HomeClickstreamAnalytics"===(null==(t=e.data)?void 0:t.__typename)){const t=e.data,a=D(t);if(a)return i.createElement(p.E0,{trackOnce:!0,eventData:a},i.createElement(i.Fragment,null,n))}if("ClientSideAnalytics"===(null==(a=e.data)?void 0:a.__typename)){const t=e.data;return i.createElement(p.ee,{trackOnce:!0,linkName:t.linkName,referrerId:t.referrerId},i.createElement(i.Fragment,null,n))}return i.createElement(i.Fragment,null,n)},b={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"MojoGraphQLMutation"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"context"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ContextInput"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"mojoMutationContext"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"MojoMutationContextInput"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"mojoMutation"},arguments:[{kind:"Argument",name:{kind:"Name",value:"context"},value:{kind:"Variable",name:{kind:"Name",value:"context"}}},{kind:"Argument",name:{kind:"Name",value:"mojoMutationContext"},value:{kind:"Variable",name:{kind:"Name",value:"mojoMutationContext"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"isSuccessful"},arguments:[],directives:[]}]}}]}}],loc:{start:0,end:218,source:{body:"\n  mutation MojoGraphQLMutation($context: ContextInput!, $mojoMutationContext: MojoMutationContextInput!) {\n    mojoMutation(context: $context, mojoMutationContext: $mojoMutationContext) {\n      isSuccessful\n    }\n  }\n",name:"GraphQL request",locationOffset:{line:1,column:1}}}},x=()=>{const e=(0,p.KY)(),n=(0,p.iQ)();return t=>{var i,a;if("HomeClickstreamAnalytics"===(null==(i=t.data)?void 0:i.__typename)){const e=t.data,i=D(e);if(i)return void n(i)}if("ClientSideAnalytics"===(null==(a=t.data)?void 0:a.__typename)){const n=t.data;return void e(n.referrerId,n.linkName)}}},_={kind:"Document",definitions:S([{kind:"FragmentDefinition",name:{kind:"Name",value:"HomeClickstreamButtonFragment"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"HomeClickstreamButton"}},directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"button"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"accessibility"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"primary"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"disabled"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"clickstreamAnalytics"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"HomeClickstreamAnalyticsFragment"},directives:[]}]}}]}}].concat(F.definitions)),loc:{start:0,end:236,source:{body:"\n  fragment HomeClickstreamButtonFragment on HomeClickstreamButton {\n    button {\n      __typename\n      accessibility\n      primary\n      disabled\n    }\n    clickstreamAnalytics {\n      ...HomeClickstreamAnalyticsFragment\n    }\n  }\n  \n".concat([F.loc.source.body].join("\n")),name:"GraphQL request",locationOffset:{line:1,column:1}}}},E=e=>{const{data:n,onDismiss:t}=e,a=x(),r=n.clickstreamAnalytics?n.clickstreamAnalytics:null;return i.createElement(N.y,{onClick:()=>{a&&a({data:r}),t()}},n.button.primary)};E.fragment=_,E.displayName="DismissButton";var A={kind:"Document",definitions:S([{kind:"FragmentDefinition",name:{kind:"Name",value:"HomeUILinkFragment"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"HomeUILink"}},directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"text"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"size"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"action"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"accessibility"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"clickstreamAnalytics"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"HomeClickstreamAnalyticsFragment"},directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"resource"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"value"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"target"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"useRelativePath"},arguments:[],directives:[]}]}}]}}].concat(F.definitions)),loc:{start:0,end:283,source:{body:"\n  fragment HomeUILinkFragment on HomeUILink {\n    text\n    size\n    action {\n      __typename\n      accessibility\n      clickstreamAnalytics {\n        ...HomeClickstreamAnalyticsFragment\n      }\n      resource {\n        value\n      }\n      target\n      useRelativePath\n    }\n  }\n  \n".concat([F.loc.source.body].join("\n")),name:"GraphQL request",locationOffset:{line:1,column:1}}}},h=e=>{const{data:n,onDismiss:t}=e,{text:a,action:r}=n,l=x(),m=r.clickstreamAnalytics?r.clickstreamAnalytics:null;return i.createElement(f.i,{align:"center",size:"medium",onClick:()=>{l&&l({data:m}),t()}},i.createElement("a",{href:r.resource.value,target:r.target,rel:"noopener"},a))};h.fragment=A,h.displayName="ViewRewardsLink";var I={kind:"Document",definitions:S([{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"IncentiveQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"context"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ContextInput"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"requestDate"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"incentive"},arguments:[{kind:"Argument",name:{kind:"Name",value:"context"},value:{kind:"Variable",name:{kind:"Name",value:"context"}}},{kind:"Argument",name:{kind:"Name",value:"requestDate"},value:{kind:"Variable",name:{kind:"Name",value:"requestDate"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"heading"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"text"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"description"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"text"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"dismissButton"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"HomeClickstreamButtonFragment"},directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"viewRewardsLink"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"HomeUILinkFragment"},directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"expirationDate"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"incentiveDetailId"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"clickstreamImpressionTracking"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"HomeClickstreamAnalyticsFragment"},directives:[]}]}}]}}]}}].concat(E.fragment.definitions,h.fragment.definitions,F.definitions)),loc:{start:0,end:517,source:{body:"\n  query IncentiveQuery($context: ContextInput!, $requestDate: String) {\n    incentive(context: $context, requestDate: $requestDate) {\n      __typename\n      heading {\n        text\n      }\n      description {\n        text\n      }\n      dismissButton {\n        ...HomeClickstreamButtonFragment\n      }\n      viewRewardsLink {\n        ...HomeUILinkFragment\n      }\n      expirationDate\n      incentiveDetailId\n      clickstreamImpressionTracking {\n        ...HomeClickstreamAnalyticsFragment\n      }\n    }\n  }\n  \n  \n  \n".concat([E.fragment.loc.source.body,h.fragment.loc.source.body,F.loc.source.body].join("\n")),name:"GraphQL request",locationOffset:{line:1,column:1}}}},L=e=>{var n,t;const{context:p}=(0,g.R)(),{inputs:N,triggerRef:f}=e,[S,F]=i.useState(!0),D=i.useRef(null),x=(0,y.useExperiment)("Incentives_on_Home_Placeholder").exposure.bucket>0,_={...N,context:p},{data:A,error:L,loading:H}=(0,v.IT)(I,{context:{shouldLogPerformance:!0},variables:_,ssr:!1}),T=((e,n)=>{const[t]=(0,v.n_)(b,{variables:{context:e,mojoMutationContext:{mutationId:"dismiss-incentives",pageName:"home",payload:JSON.stringify(n)}}});return t})(p,{incentiveDetailId:null==(n=null==A?void 0:A.incentive)?void 0:n.incentiveDetailId,expirationDate:null==(t=null==A?void 0:A.incentive)?void 0:t.expirationDate}),M=(0,i.useCallback)(()=>{F(!1),T()},[T]);if((0,i.useEffect)(()=>{function e(e){0===e.button&&1===e.detail&&D.current&&!D.current.contains(e.target)&&M()}return document.addEventListener("click",e),()=>{document.removeEventListener("click",e)}},[M]),!x||!S)return null;if(H||L||!A||!A.incentive)return null;const{incentive:j}=A,{heading:w,description:V,dismissButton:O,viewRewardsLink:q,clickstreamImpressionTracking:B}=j;return i.createElement(C,{element:{data:B}},i.createElement(k.EGDSThemeProvider,{config:{lightMode:{colorTheme:"marketing-3"},darkMode:{colorTheme:"dark-2"}}},i.createElement("div",{ref:D},i.createElement(d.t,{"data-theme-light":"marketing-3","data-theme-dark":"dark-2",isVisible:S,triggerRef:f,position:{block:"trailing",inline:"trailing"},applyBlockStartMargin:!0,autoPosition:!0,width:330,showOverTrigger:!1,type:"popover"},i.createElement(s.Y,null,i.createElement(m.w,{space:"two",justifyItems:"center"},i.createElement(o.T,null,i.createElement(c.M,{align:"center",size:1,typeStyle:{customTheme:"standard",customStyle:"display-small"},overflow:"wrap"},w.text)),i.createElement(o.T,null,i.createElement(u.D,{align:"center",size:300,weight:"regular",overflow:"wrap"},V.text)),i.createElement(o.T,null,i.createElement(r.X,{direction:"row",alignContent:"center",justifyContent:"center",space:"one"},i.createElement(l.C,{alignSelf:"center"},i.createElement("div",null,i.createElement(h,{onDismiss:M,data:q}))),i.createElement(l.C,{alignSelf:"center"},i.createElement(a.LD,{name:"icon__onekey",size:a.So.SMALL})))),i.createElement(o.T,null,i.createElement(E,{data:O,onDismiss:M}))))))))};L.displayName="sharedui-Incentive"}}]);
//# sourceMappingURL=https://bernie-assets.s3.us-west-2.amazonaws.com/landing-pwa/shared-ui-retail-storefront-incentive.539bef4a7c6c3d6649ba.js.map