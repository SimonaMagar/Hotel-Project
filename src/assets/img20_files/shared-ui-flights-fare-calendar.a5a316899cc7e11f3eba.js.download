/*@license For license information please refer to shared-ui-flights-fare-calendar.licenses.txt*/
(self.__LOADABLE_LOADED_CHUNKS__=self.__LOADABLE_LOADED_CHUNKS__||[]).push([[2769],{97058:function(e,t,n){n.d(t,{Yk:function(){return P},x3:function(){return I}});var a=n(96540),i=n(20181),r=n.n(i),o=n(57527),l=n(23752),d=n(22828),s=n(9705),c=n(62547),u=n(69633),m=n(2507),g=n(39656),C=n(8142),k=n.n(C),p=n(1023),D=n(22913),v=n(59671),h=Object.defineProperty,f=Object.defineProperties,y=Object.getOwnPropertyDescriptors,N=Object.getOwnPropertySymbols,F=Object.prototype.hasOwnProperty,S=Object.prototype.propertyIsEnumerable,T=(e,t,n)=>t in e?h(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,B=(e,t)=>{for(var n in t||(t={}))F.call(t,n)&&T(e,n,t[n]);if(N)for(var n of N(t))S.call(t,n)&&T(e,n,t[n]);return e},b=(e,t)=>f(e,y(t));function _(e){const t=Date.parse(e);if(Number.isNaN(t)||!function(e){return/^(\d{4})-(\d{2})-(\d{2})$/.test(e)||/^\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\dZ$/.test(e)}(e))throw Error(`Failed to convert ${e} to a valid date.`);const n=new Date(e);return a=n,new Date(a.getUTCFullYear(),a.getUTCMonth(),a.getUTCDate(),a.getUTCHours(),a.getUTCMinutes(),a.getUTCSeconds());var a}function x(){const e=new Date;return new Date(e.getFullYear(),e.getMonth(),e.getDate())}function E(e,t){const n=Math.floor((t.getTime()-e.getTime())/864e5);return n>0?`+${n}`:`${n}`}var O=(e,t)=>{const n=e?"ONE_WAY":"ROUND_TRIP",a=e?"OW":"RT";return{onChangeEndDateCB:{id:`${n}_FC_onChangeEndDateCB`,description:"Returning date Change"},onChangeMonthCB:{id:`${n}_FC_onChangeMonthCB`,description:"Month changed"},onChangeStartDateCB:{id:`${n}_FC_onChangeStartDateCB`,description:"Departing date Change"},onOpenCB:{id:`${n}_FC_onOpenCB`,description:"Open Date Picker"},onDismissCB:{id:`${n}_FC_onDismissCB`,description:"Close Date Picker"},onSubmitCB:{id:`${n}_FC_onSubmitCB`,description:"Save Dates"},onDoneButtonCB:{id:"FLT.FareCalendar.Done",description:"Done Button Clicked"},onChangeFlexStartDateCB:{id:`FLT.${a}.FareCalendar.DateChange.OB.${t}`,description:"Outbound Date Change"},onChangeFlexEndDateCB:{id:`FLT.${a}.FareCalendar.DateChange.IB.${t}`,description:"Inbound Date Change"}}},A={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"FareCalendarQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"context"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ContextInput"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"journeyCriteria"}},type:{kind:"NonNullType",type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"FlightsJourneyCriteriaInput"}}}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"flightsSearchContext"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"FlightsSearchContextInput"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"flightsFareCalendar"},arguments:[{kind:"Argument",name:{kind:"Name",value:"context"},value:{kind:"Variable",name:{kind:"Name",value:"context"}}},{kind:"Argument",name:{kind:"Name",value:"journeyCriteria"},value:{kind:"Variable",name:{kind:"Name",value:"journeyCriteria"}}},{kind:"Argument",name:{kind:"Name",value:"flightsSearchContext"},value:{kind:"Variable",name:{kind:"Name",value:"flightsSearchContext"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"disclaimerText"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"priceLockupText"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"coverageAnalytics"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"linkName"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"referrerId"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"datePickerCellContents"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"date"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"formatted"},arguments:[{kind:"Argument",name:{kind:"Name",value:"format"},value:{kind:"StringValue",value:"yyyy-MM-dd",block:!1}}],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"accessibility"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"selectAnalytics"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"linkName"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"referrerId"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"content"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"price"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"amount"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"formatted"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"priceTheme"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"valueText"},arguments:[],directives:[]}]}}]}}]}}]}}],loc:{start:0,end:762,source:{body:'\n  query FareCalendarQuery(\n    $context: ContextInput!\n    $journeyCriteria: [FlightsJourneyCriteriaInput!]!\n    $flightsSearchContext: FlightsSearchContextInput!\n  ) {\n    flightsFareCalendar(context: $context, journeyCriteria: $journeyCriteria, flightsSearchContext: $flightsSearchContext) {\n      disclaimerText\n      priceLockupText\n      coverageAnalytics {\n        linkName\n        referrerId\n      }\n      datePickerCellContents {\n        date {\n          formatted(format: "yyyy-MM-dd")\n        }\n        accessibility\n        selectAnalytics {\n          linkName\n          referrerId\n        }\n        content {\n          price {\n            amount\n            formatted\n          }\n          priceTheme\n          valueText\n        }\n      }\n    }\n  }\n',name:"GraphQL request",locationOffset:{line:1,column:1}}}},M=()=>{const[e,t]=a.useState({datePickerContent:{},concatenatedResult:{}}),[n,i]=a.useState(""),[r,o]=a.useState(""),[l,d]=a.useState({}),[s,u]=a.useState({}),[m,g]=a.useState(!1),[C,h]=a.useState(""),[f,y]=a.useState(!1),{context:N}=(0,D.R)(),{formatDate:F}=(0,c.useLocalization)(),{error:S}=(0,v.useLogger)(),[T,{data:E,error:O}]=(0,p._l)(A,{ssr:!1,fetchPolicy:"no-cache"});a.useEffect(()=>{if(h(""),O&&S("FARE_CALENDAR_FETCH_ERROR"),(null==E?void 0:E.flightsFareCalendar)&&E.flightsFareCalendar.datePickerCellContents.length>0){const[n,a,r]=(e=>{const t={},n={},a={};return e.flightsFareCalendar.datePickerCellContents.map(e=>{var i;return t[null==(i=e.date)?void 0:i.formatted]={className:e.content.priceTheme.toLowerCase(),ariaLabel:e.accessibility,text:e.content.valueText},n[e.date.formatted]={analytics:{referrerId:e.selectAnalytics.referrerId,linkName:e.selectAnalytics.linkName}},a[e.date.formatted]={price:e.content.price?e.content.price.amount:e.content.valueText,priceWithCurrency:e.content.valueText},[t,n,a]}),[t,n,a]})(E);k()(e.datePickerContent,n)||t({datePickerContent:n,concatenatedResult:m?B(B({},e.concatenatedResult),n):n}),E.flightsFareCalendar.priceLockupText?(y(!0),h(E.flightsFareCalendar.priceLockupText)):(y(!1),h(E.flightsFareCalendar.disclaimerText)),i(E.flightsFareCalendar.coverageAnalytics.referrerId),o(E.flightsFareCalendar.coverageAnalytics.linkName),d(a),u(r)}},[E,O,S]);const M=(e,t)=>{const n=x(),a=e<n?n:e;let i=a;return t&&(i=function(e,t){const n=_(e),a=_(e);return a.setDate(n.getDate()+t),a}(F(e,{raw:"yyyy-MM-dd"}),14)),{departureDate:a,returnDate:i}};return[(e,n,a,i,r,o)=>{o||t({datePickerContent:{},concatenatedResult:{}}),g(o);const{departureDate:l,returnDate:d}=M(i,r);let s=[{departureDate:{day:l.getDate(),month:l.getMonth()+1,year:l.getFullYear()},destination:n,origin:e}];l!==d&&(s=[{departureDate:{day:l.getDate(),month:l.getMonth()+1,year:l.getFullYear()},destination:n,origin:e},{departureDate:{day:d.getDate(),month:d.getMonth()+1,year:d.getFullYear()},destination:e,origin:n}]);const c=b(B({},{context:N,journeyCriteria:s,flightsSearchContext:{tripType:a}}),{context:N});T({variables:c})},e.concatenatedResult,C,n,r,l,s,f]},P=(e=>(e.ONE_WAY="ONE_WAY",e.ROUND_TRIP="ROUND_TRIP",e.FLEX_DATE_ONE_WAY="OW",e.FLEX_DATE_ROUND_TRIP="RT",e))(P||{}),R=(e,t)=>e?t(e,{raw:"yyyy-MM-dd"}):"",L=e=>{const{destination:t,dateFieldProps:n,endDate:i,firstDayOfWeek:m,onChange:g,onMountCB:C,origin:k,singleMode:p,startDate:D,startDateName:v,tripType:h,onSubmitAnalytics:f,dialogWrapper:y,openDialog:N,dismissDialog:F,onOpenCB:S,autoOpen:T,onDoneButtonClickCB:A,singleTrigger:P}=e,[L,I,$,w,Y,W,j,U]=((e,t,n)=>{const[a,i,r,o,l,d,s,c]=M();return[(i,r,o)=>{a(e,t,n,i,r,o)},i,r,o,l,d,s,c]})(k,t,h),[V,H]=a.useState(!1),K=a.useRef(!1),q=a.useRef(!1),[J,Q]=a.useState(!1),[z,X]=a.useState(!1),[G,Z]=a.useState(!1),[ee,te]=a.useState(x()),[ne,ae]=a.useState(x()),[ie,re]=a.useState(""),{formatDate:oe}=(0,c.useLocalization)(),le=O(p),de=(0,d.KY)(),se=e=>{de(e.id,e.description)},ce=e=>{var t;const n=null==(t=j[R(e,oe)])?void 0:t.priceWithCurrency;re(n&&"-"!==n?n:"")},ue=()=>{p||(Z(!0),L(ee,!0,!1),ce(ee))};(0,s._H)(u.Jm,u.ht,{onSuccess:()=>{H(!0)}});const me=e=>{F(e),se(le.onDismissCB),H(!1),K.current=!1},ge=(e,t)=>{var n,a;const i=R(e,oe),r=R(t,oe);return[{fieldName:"startDate",value:i,price:null==(n=j[i])?void 0:n.price},{fieldName:"endDate",value:r,price:null==(a=j[r])?void 0:a.price}]},Ce=(e,t,n)=>{if(e){const n=ge(e,t);g(n),Z(!1),se(le.onSubmitCB)}(()=>{if(f){w&&Y&&de(w,Y);const e="ONE_WAY"===h?ee:ne,t=R(e,oe);W&&e&&W[t]&&de(W[t].analytics.referrerId,W[t].analytics.linkName)}})(),me(n)};a.useEffect(()=>{te(D?_(D):x()),ae(i?_(i):x()),ce(D?_(D):x())},[D,i]),a.useEffect(()=>{T&&(L(ee,!1,!1),H(!0))},[]),a.useEffect(()=>{p||ce(ne)},[ne,j]);const ke=r()(e=>{const t=R(e,oe);G||K.current||(null==I?void 0:I[t])||!q.current||L(e,G,!0),K.current&&(K.current=!1)},1e3),pe=b(B({},n),{routerLinkWrapper:e=>a.createElement(a.Fragment,null,e),onChange:g,showDatePicker:n.showDatePicker?n.showDatePicker:V,endName:"endDate",startName:null!=v?v:"startDate"}),De=R(new Date(ee.getFullYear(),ee.getMonth(),ee.getDate()),oe),ve=z?De:"",he={buttonText:n.buttonText,currentPrice:ie,dateFieldProps:pe,datePickerContent:I,daysBookableInAdvance:330,dialogWrapper:y,doubleMonths:!0,singleDateSelect:!0,endDate:i?R(new Date(ne.getFullYear(),ne.getMonth(),ne.getDate()),oe):"",firstDayOfWeek:m,footerText:$,singleMode:p,midnightBookingOffset:4,onDismissCB:me,onOpenCB:(e,t)=>{N(e,t),Q(t),ce(D?_(D):x()),H(!0),se(le.onOpenCB),null==S||S(e),"end"===e?ue():(L(new Date(ee.getFullYear(),ee.getMonth(),1),!1,!1),q.current=!0,K.current=!0)},onMountCB:C,onSubmitCB:Ce,onChangeMonthCB:e=>{G&&"ROUND_TRIP"===h||L(e,G,!1),se(le.onChangeMonthCB)},onChangeStartDateCB:e=>{te(e),p&&ce(e),p||(ne&&e>ne&&(ae(new Date(e.getFullYear(),e.getMonth(),e.getDate()+1)),q.current=!1),te(e),X(!0),Z(!0),L(e,!0,!1)),se(le.onChangeStartDateCB);const t=O(p,E(ee,e));se(t.onChangeFlexStartDateCB)},onChangeEndDateCB:e=>{ae(e),Z(!1),se(le.onChangeEndDateCB);const t=O(p,E(ne,e));se(t.onChangeFlexEndDateCB)},startDate:D?De:ve,onSelectEndModeCB:ue,onScrollHandler:ke,onDoneButtonClickCB:(e,t)=>{Ce(e,t,J),se(le.onDoneButtonCB);const n=ge(e,t);null==A||A(e,n,t)},useSingleTrigger:P};return U?a.createElement(o.gs,B({},he)):a.createElement(l.e5,B({},he))},I=e=>{const[t,n,i]=(()=>{const[e,t,n]=(0,g.useDialog)("datepicker-start"),[i,r,o]=(0,g.useDialog)("datepicker-end");return[(t,r)=>"end"===r?a.createElement(m.K,{isVisible:i},a.createElement(o,null,a.createElement(a.Fragment,null,t))):a.createElement(m.K,{isVisible:e},a.createElement(n,null,a.createElement(a.Fragment,null,t))),(e,n)=>{n&&("end"===e?r.openDialog():t.openDialog())},e=>{e&&(i?r.closeDialog():t.closeDialog())}]})();return a.createElement(L,B({},b(B({},e),{dialogWrapper:t,openDialog:n,dismissDialog:i})))};I.displayName="FareCalendar"}}]);
//# sourceMappingURL=https://bernie-assets.s3.us-west-2.amazonaws.com/landing-pwa/shared-ui-flights-fare-calendar.a5a316899cc7e11f3eba.js.map