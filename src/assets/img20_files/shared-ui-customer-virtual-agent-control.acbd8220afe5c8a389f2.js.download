/*@license For license information please refer to shared-ui-customer-virtual-agent-control.licenses.txt*/
(self.__LOADABLE_LOADED_CHUNKS__=self.__LOADABLE_LOADED_CHUNKS__||[]).push([[2362],{41781:function(e,n,i){i.d(n,{Jx:function(){return C},ki:function(){return f}});var t=i(96540),o=i(1023),a=i(22913),l=i(59671),r=i(72211);var s=Object.defineProperty,d=Object.defineProperties,v=Object.getOwnPropertyDescriptors,c=Object.getOwnPropertySymbols,u=Object.prototype.hasOwnProperty,p=Object.prototype.propertyIsEnumerable,m=(e,n,i)=>n in e?s(e,n,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[n]=i,k=(e,n)=>{for(var i in n||(n={}))u.call(n,i)&&m(e,i,n[i]);if(c)for(var i of c(n))p.call(n,i)&&m(e,i,n[i]);return e},P=(e,n)=>d(e,v(n));async function g(){var e;if((null==window?void 0:window.virtualAgentControl)&&await window.virtualAgentControl.isInitialized)return window.virtualAgentControl;if((null==(e=null==window?void 0:window.VirtualAgentControl)?void 0:e.initialized)&&(null==window?void 0:window.VacClientAdapter)){if(await window.VirtualAgentControl.initialized){const e=await window.VacClientAdapter.getInstance();if(await e.isInitialized)return e}}}async function C(e){const n=await g(),{intentMessage:i,conversationProperties:t,silent:o}=e||{};n&&(i||t)&&n.setConversationContext({intentMessage:i,conversationProperties:t},o)}var h={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"ChatbotConfigQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"context"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ContextInput"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"applicationName"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"chatbotConfig"},arguments:[{kind:"Argument",name:{kind:"Name",value:"context"},value:{kind:"Variable",name:{kind:"Name",value:"context"}}},{kind:"Argument",name:{kind:"Name",value:"applicationName"},value:{kind:"Variable",name:{kind:"Name",value:"applicationName"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"authToken"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"channelOriginId"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"chatbotCapabilities"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"conversationProperties"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"launchPoint"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"traceId"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"enableAutoOpenChatWidget"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"enableProactiveConversation"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"version"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"javascriptUrl"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"value"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"versionId"},arguments:[],directives:[]}]}}]}}]}}],loc:{start:0,end:462,source:{body:"\n  query ChatbotConfigQuery($context: ContextInput!, $applicationName: String!) {\n    chatbotConfig(context: $context, applicationName: $applicationName) {\n      authToken\n      channelOriginId\n      chatbotCapabilities\n      conversationProperties {\n        launchPoint\n        traceId\n      }\n      enableAutoOpenChatWidget\n      enableProactiveConversation\n      version {\n        javascriptUrl {\n          value\n        }\n        versionId\n      }\n    }\n  }\n",name:"GraphQL request",locationOffset:{line:1,column:1}}}},b={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"localChatClient"},variableDefinitions:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"localChatClientState"},arguments:[],directives:[{kind:"Directive",name:{kind:"Name",value:"client"},arguments:[]}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"requested"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"isEventHandlerRegistered"},arguments:[],directives:[]}]}}]}}],loc:{start:0,end:119,source:{body:"\n  query localChatClient {\n    localChatClientState @client {\n      requested\n      isEventHandlerRegistered\n    }\n  }\n",name:"GraphQL request",locationOffset:{line:1,column:1}}}},N={__typename:"LocalChatClientState",requested:!1},f=e=>{var n,i,s;const{applicationName:d,clientOverrides:v,pageName:c,skipSsr:u}=e,{context:p}=(0,a.R)(),{error:m,info:C}=(0,l.useLogger)(),{locale:f}=p,I={context:p,applicationName:d},[w,S]=t.useState(),[A,O]=t.useState(!1),[,T]=(0,r.A9)(),_=Boolean(w),{data:y}=(0,o.IT)(h,{context:{shouldLogPerformance:!0},variables:I,ssr:!u,skip:_}),{data:E,client:D}=(0,o.IT)(b,{ssr:!u}),F=()=>{T({type:"virtualAgentInitialized"})},V=()=>m("STRATBOT_VAC_SCRIPT_FAILED_TO_LOAD");t.useEffect(()=>{if(!w)if(!(null==y?void 0:y.chatbotConfig)||E&&E.localChatClientState.requested||A)g().then(e=>{e&&(S(e),F())});else{O(!0),D.writeQuery({query:b,data:P(k({},y||{}),{localChatClientState:P(k({},N),{requested:!0,isEventHandlerRegistered:!0})})});const{chatbotConfig:e,chatbotConfig:{version:{javascriptUrl:n}}}=y,i=(null==v?void 0:v.authToken)||function(e){if("function"==typeof window.atob){const n=window.atob(e);return JSON.parse(n)}}(e.authToken),t=function(e,n,i,t,o){var a,l,r,s,d,v,c,u,p,m,k,P,g,C,h,b,N,f,I,w,S,A,O,T,_,y,E,D,F,V,L,R,x;const q={authToken:t,channelOriginId:(null==o?void 0:o.channelOriginId)||(null==e?void 0:e.channelOriginId),capabilities:(null==e?void 0:e.chatbotCapabilities)?(H=null==e?void 0:e.chatbotCapabilities,H.map(e=>{switch(e){case"CLICKSTREAM":return"Clickstream";case"GLASSBOX":return"Glassbox";default:return""}}).filter(e=>""!==e)):[],containerElement:null==o?void 0:o.containerElement,conversationProperties:{launchPoint:(null==(a=null==o?void 0:o.conversationProperties)?void 0:a.launchPoint)||(null==e?void 0:e.conversationProperties.launchPoint),traceId:null==e?void 0:e.conversationProperties.traceId,pageName:n},embedded:null==o?void 0:o.embedded,enableAutoOpenChatWidget:(null==o?void 0:o.enableAutoOpenChatWidget)||(null==e?void 0:e.enableAutoOpenChatWidget),enableProactiveConversation:(null==o?void 0:o.enableProactiveConversation)||(null==e?void 0:e.enableProactiveConversation),fastRender:"V2"===(null==e?void 0:e.version.versionId),intentMessage:null==o?void 0:o.intentMessage,languageId:(null==o?void 0:o.languageId)||i,subscribedEvents:null==o?void 0:o.subscribedEvents,eventHandler:null==o?void 0:o.eventHandler,userProperties:null==o?void 0:o.userProperties,configurationOverrides:null==o?void 0:o.configurationOverrides};var H;return(null==(l=null==o?void 0:o.conversationProperties)?void 0:l.skipWelcome)&&(q.conversationProperties.skipWelcome=null==(r=null==o?void 0:o.conversationProperties)?void 0:r.skipWelcome),(null==(s=null==o?void 0:o.conversationProperties)?void 0:s.listingId)&&(q.conversationProperties.listingId=null==(d=null==o?void 0:o.conversationProperties)?void 0:d.listingId),(null==(v=null==o?void 0:o.conversationProperties)?void 0:v.checkin)&&(q.conversationProperties.checkin=null==(c=null==o?void 0:o.conversationProperties)?void 0:c.checkin),(null==(u=null==o?void 0:o.conversationProperties)?void 0:u.checkout)&&(q.conversationProperties.checkout=null==(p=null==o?void 0:o.conversationProperties)?void 0:p.checkout),(null==(m=null==o?void 0:o.conversationProperties)?void 0:m.adults)&&(q.conversationProperties.adults=null==(k=null==o?void 0:o.conversationProperties)?void 0:k.adults),(null==(P=null==o?void 0:o.conversationProperties)?void 0:P.children)&&(q.conversationProperties.children=null==(g=null==o?void 0:o.conversationProperties)?void 0:g.children),(null==(C=null==o?void 0:o.conversationProperties)?void 0:C.pets)&&(q.conversationProperties.pets=null==(h=null==o?void 0:o.conversationProperties)?void 0:h.pets),(null==(b=null==o?void 0:o.conversationProperties)?void 0:b.currency)&&(q.conversationProperties.currency=null==(N=null==o?void 0:o.conversationProperties)?void 0:N.currency),(null==(f=null==o?void 0:o.conversationProperties)?void 0:f.device)&&(q.conversationProperties.device=null==(I=null==o?void 0:o.conversationProperties)?void 0:I.device),(null==(w=null==o?void 0:o.conversationProperties)?void 0:w.bookNow)&&(q.conversationProperties.bookNow=null==(S=null==o?void 0:o.conversationProperties)?void 0:S.bookNow),(null==(A=null==o?void 0:o.conversationProperties)?void 0:A.havId)&&(q.conversationProperties.havId=null==(O=null==o?void 0:o.conversationProperties)?void 0:O.havId),(null==(T=null==o?void 0:o.conversationProperties)?void 0:T.site)&&(q.conversationProperties.site=null==(_=null==o?void 0:o.conversationProperties)?void 0:_.site),(null==(y=null==o?void 0:o.conversationProperties)?void 0:y.hostname)&&(q.conversationProperties.hostname=null==(E=null==o?void 0:o.conversationProperties)?void 0:E.hostname),(null==(D=null==o?void 0:o.conversationProperties)?void 0:D.chatbotName)&&(q.conversationProperties.chatbotName=null==(F=null==o?void 0:o.conversationProperties)?void 0:F.chatbotName),(null==(V=null==o?void 0:o.conversationProperties)?void 0:V.chatbotEntryPoint)&&(q.conversationProperties.chatbotEntryPoint=null==(L=null==o?void 0:o.conversationProperties)?void 0:L.chatbotEntryPoint),(null==(R=null==o?void 0:o.conversationProperties)?void 0:R.buttonId)&&(q.conversationProperties.buttonId=null==(x=null==o?void 0:o.conversationProperties)?void 0:x.buttonId),(null==o?void 0:o.conversationId)&&(null==o?void 0:o.participantId)&&(null==o?void 0:o.mode)&&(q.conversationId=o.conversationId,q.participantId=o.participantId,q.mode=o.mode),q}(e,c,f,i,v),o=()=>{(async function(e){return(null==window?void 0:window.virtualAgentControl)?window.virtualAgentControl:(null==window?void 0:window.VacClientAdapter)?window.VacClientAdapter.getInstance(e):void 0})(i).then(e=>{e?e.initialize(t).then(()=>{g().then(e=>{e?(S(e),F(),C("STRATBOT_VAC_INIT_SUCCEEDED")):m("STRATBOT_VAC_INIT_NO_VALID_CHAT_CLIENT_FOUND")})}).catch(e=>{m("STRATBOT_VAC_INIT_FAILED",e)}):m("STRATBOT_VAC_FAILED_TO_FIND_INSTANCE_TO_INIT")}).catch(e=>{m("STRATBOT_VAC_ERROR_GETTING_INSTANCE_TO_INIT",e)})};document.head.appendChild(function(e,n,i){const t=document.createElement("script");return t.src=e,t.onload=n,t.onerror=i,t}(n.value,o,V))}},[w,y,E,A,D,c,f,v,F,m,C,V]),t.useEffect(()=>{const{intentMessage:e,conversationProperties:n,silent:i=!0}=v||{};if(w&&(e||n)){const t=Object.assign(n||{},{pageName:c});w.setConversationContext({intentMessage:e,conversationProperties:t},i)}},[null==(n=null==v?void 0:v.intentMessage)?void 0:n.intent,null==(i=null==v?void 0:v.conversationProperties)?void 0:i.launchPoint,null==(s=null==v?void 0:v.conversationProperties)?void 0:s.skipWelcome]);const{subscribedEvents:L,eventHandler:R}=v||{},x=t.useMemo(()=>R,[]);return t.useEffect(()=>(((e,n,i,t)=>{var o;e&&n&&i&&!1===(null==(o=null==t?void 0:t.localChatClientState)?void 0:o.isEventHandlerRegistered)&&e.on(n,i)})(w,L,x,E),()=>{((e,n,i,t,o,a)=>{i&&a&&t&&o&&(i.off(t,o),n.writeQuery({query:e,data:{localChatClientState:P(k({},a.localChatClientState),{isEventHandlerRegistered:!1})}}))})(b,D,w,L,x,E)}),[w,L,x,E,D]),null};f.displayName="sharedui-VirtualAgentControl"}}]);
//# sourceMappingURL=https://bernie-assets.s3.us-west-2.amazonaws.com/landing-pwa/shared-ui-customer-virtual-agent-control.acbd8220afe5c8a389f2.js.map