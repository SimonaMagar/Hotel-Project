(this.$WP=this.$WP||[]).push(["u6ipay",(e,a)=>{function t({isDragToDismissEnabled:e,isOpen:a,onClose:t,children:r}){var n=c(null),o=c(null),s=c(null),l=C({in:a,timeout:250}),m=u(e=>{var a,r;a=.5*e.modalHeight,(e.deltaY>a||e.velocity>3)&&t?.(),n.current&&((r=n.current).style.transition="",r.style.transform=""),s.current=null},[t]),p=u(e=>{if(s.current){var a,t=Date.now(),r=e-s.current.startY,i=t-s.current.lastTime,o=i>0?(e-s.current.lastY)/i:0;s.current={...s.current,currentY:e,deltaY:r,lastY:e,lastTime:t,velocity:o},n.current&&((a=n.current).style.transform=`translateY(${Math.max(0,r)}px)`,a.style.transition="none")}},[]),g=u(e=>{var{target:a}=e;if(a instanceof Element&&null===a.closest('button,a[href],input,select,textarea,summary,label[for],[tabindex]:not([tabindex="-1"]),[onclick],[onmousedown],[onpointerdown]')&&n.current){e.preventDefault();var t=n.current.offsetHeight,r=Date.now();s.current={isDragging:!0,startY:e.clientY,currentY:e.clientY,deltaY:0,startTime:r,lastY:e.clientY,lastTime:r,modalHeight:t,velocity:0},e.currentTarget.setPointerCapture(e.pointerId)}},[]),f=u(e=>{s.current?.isDragging&&p(e.clientY)},[p]),v=u(e=>{s.current?.isDragging&&(e.currentTarget.releasePointerCapture(e.pointerId),m(s.current))},[m]);d(()=>{if(window.visualViewport){var e=()=>{if(n.current){var e=`${window.visualViewport?.height??0}px`;n.current.style.minHeight=e,n.current.style.height=e,n.current.style.maxHeight=e}};return window.visualViewport.addEventListener("resize",e),window.visualViewport.addEventListener("scroll",e),e(),()=>{window.visualViewport?.removeEventListener("resize",e),window.visualViewport?.removeEventListener("scroll",e)}}},[n]);var T=h(()=>({dragRef:o,modalRef:n,status:l,handlers:{onPointerDown:e?g:void 0,onPointerMove:e?f:void 0,onPointerUp:e?v:void 0}}),[g,f,v,e,l]);return i(ad.Provider,{value:T,children:r})}function r(){var e=p(ad);if(!e)throw Error("useChatModal must be used within a ChatModalProvider");return e}var n,i,o,s,l,d,c,u,h,m,p,g,f,v,T,b,E,y,I,C,N,_,S,M,k,R,P,A,w,L,O,D,B,Q,z,x,H,W,V,K,q,Y,G,j,F,U,Z,X,J,$,ee,ea,et,er,en,ei,eo,es,el,ed,ec,eu,eh,em,ep,eg,ef,ev,eT,eb,eE,ey,eI,eC,eN,e_,eS,eM,ek,eR,eP,eA,ew,eL,eO,eD,eB,eQ,ez,ex,eH,eW,eV,eK,eq,eY,eG,ej,eF,eU,eZ,eX,eJ,e$,e0,e1,e2,e4,e3,e6,e9,e7,e5,e8,ae,aa,at,ar,an,ai,ao,as,al,ad,ac,au,ah,am,ap,ag,af,av,aT,ab,aE,ay,aI,aC,aN,a_,aS,aM,ak,aR,aP,aA,aw,aL,aO,aD,aB,aQ,az,ax,aH,aW,aV,aK,aq,aY,aG,aj,aF,aU,aZ,aX,aJ,a$,a0,a1,a2,a4,a3,a6,a9,a7,a5,a8,te,ta,tt,tr,tn,ti,to=({onOpenThreadsPanel:e,createNewThread:a,onClose:t})=>{var{dragRef:o,handlers:s}=r();return n("div",{ref:o,className:"AnwDP E Za t e u _s",...s,children:[i("div",{className:"qeNsW"}),n("div",{className:"drhWR u",children:[n("div",{className:"YLykM H u",children:[i(q,{onClick:e,icon:ae,"aria-label":as.header.openThreadsPanelButtonAriaLabel,size:"small",automationId:"aitaOpenHistory"}),i(q,{onClick:a,icon:eT,"aria-label":as.header.createNewThreadButtonAriaLabel,size:"small",automationId:"aitaCreateNewThread"})]}),n("div",{className:"EEqTI u",children:[i(aa,{size:16}),i(G,{atlasVariant:"fixed-label-30",elementType:"h2",color:"onSurface",children:as.header.title})]}),i("div",{className:"VppyN H u",children:i(q,{onClick:t,icon:eo,"aria-label":as.header.closeButtonAriaLabel,size:"small",automationId:"aitaCloseChat"})})]})]})},ts=({onOpenThreadsPanel:e,createNewThread:a,onClose:t})=>n("div",{className:"QjuIt _Q _U s Gm",children:[i(ac,{onClose:t,onOpenThreadsPanel:e,createNewThread:a}),i("div",{className:"TqZPK _Q",children:i(eh,{variant:"large"})})]}),tl="CfDQt _Q t s Cq Y",td="seaBD _G z _S Cq Q",tc="EtadM Rc",tu="YxPEA",th=10,tm=(e=th,a=!1,t={percentage:100})=>{var r=$(),n=c(null),[i,o]=l(!1),[s,d]=l(!a),h=u(()=>{var a=n.current;if(null!=a){var t=a.scrollWidth-a.offsetWidth-e,i=r?-a.scrollLeft:a.scrollLeft;o(i>e),d(i<t)}},[r,e]),[m,p]=l(!1),g=u(()=>{p(!1)},[]),f="percentage"in t,v=!f&&!t.excludeShadowPadding,T=f?t.percentage:t.itemWidth,b=u(a=>{var t=n.current;if(null!=t){var i=0;if(f)i=t.offsetWidth*(T/100);else{var o=t.scrollLeft<e||t.scrollWidth-t.scrollLeft<e;i=(Math.floor((t.clientWidth-(o?1:2)*20)/T)||1)*T-(v&&t.scrollLeft<e?20:0)}"back"===a?r?t.scrollLeft+=i:t.scrollLeft-=i:r?t.scrollLeft-=i:t.scrollLeft+=i,p(!0)}},[r,T,f,v,e]);return{scrollContainerProps:{ref:e=>{n.current=e,h()},onScroll:h,onTouchMove:g},scrollButtonsProps:{canScrollBack:i,canScrollForward:s,showScrollButtonsOnTouchScreens:m,scrollBack:u(()=>{b("back")},[b]),scrollForward:u(()=>{b("forward")},[b])}}},tp=({canScrollBack:e,canScrollForward:a,showScrollButtonsOnTouchScreens:t,shortShadows:r,scrollBack:o,scrollForward:s,showOnTablet:l=!1,minimizeShadowBlur:d=!1,background:c="primary",buttonSize:u=24,alignScrollToContainer:h=!1,iconVariant:m="chevron"})=>{var{localize:p}=ee();return n("div",{className:E("rRjlf _Q t l _U s S Z1",{fjrsk:e,msdKN:a,ZMzjD:!t,yusRV:l,FLexE:d,UQYoT:r,TaCdj:"secondary"===c,TnXHx:"tertiary"===c,CplIo:"rebranded"===c}),"aria-hidden":!0,children:[i("div",{className:E(tl,"rfiED l",{gVrcb:h}),children:n("button",{type:"button",tabIndex:-1,"aria-label":p.string("Previous","common_Previous"),className:E(td,{[tu]:"secondary"===c,[tc]:"arrow"===m}),disabled:!e,onClick:o,children:["chevron"===m&&i(ey,{size:u}),"arrow"===m&&i(eb,{size:u})]})}),i("div",{className:E(tl,"IFkKr _U",{azGIu:h}),children:n("button",{type:"button",tabIndex:-1,"aria-label":p.string("Next","common_Next"),className:E(td,{[tu]:"secondary"===c,[tc]:"arrow"===m}),disabled:!a,onClick:s,children:["chevron"===m&&i(eI,{size:u}),"arrow"===m&&i(eE,{size:u})]})})]})},tg="ai_assistant_in_chat_optimizations_1745937269",tf=()=>{var{experimentBuckets:e,fetching:a}=e1({experimentKeys:[tg]});return{fetching:a,enabled:e?.[tg]==="test"}},tv="ai_travel_assistant___internal_alpha_feedback_1747759102",tT=({isOpen:e,transitionDuration:a})=>{var t=C({in:e,timeout:a});return{isClosed:"exited"===t,slideOut:"enter"===t||"entering"===t||"exiting"===t||"exited"===t}},tb={fullScreenContainer:"CmEUD _Q X0 f e u c z w",errorContainer:"vvsAU f e u"},tE=({errorTitle:e,errorBody:a,buttonSize:t="small",retry:r,retryButtonTitle:o,isFullScreen:s})=>n("div",{className:s?tb.fullScreenContainer:tb.errorContainer,children:[e?i(G,{atlasVariant:"fixed-title-10",color:"onSurface",children:e}):null,i(G,{atlasVariant:"fixed-body-30",color:"onSurfaceVariant",children:a}),r&&o&&i(K,{onClick:r,variant:"secondary",size:t,children:o})]}),ty={toast:"sraSA _Q _U l Za",toastWrapper:"DSDjH"},tI=e=>{switch(e){case"error":return x;case"success":return z;case"thumbsDown":return H;case"thumbsUp":return W}},tC=({children:e})=>{var[a,t]=l(null),r=!!a?.textContent;d(()=>{var e;return r&&(e=setTimeout(()=>t(null),a?.isDurationLong?6e3:3500)),()=>clearTimeout(e)},[r,a]);var o=h(()=>({openToast:e=>{t(e)}}),[]);return n(aT.Provider,{value:o,children:[e,a?i("div",{className:ty.toast,role:"alert",children:i("div",{className:ty.toastWrapper,children:i(V,{variant:a.variant,textContent:a.textContent,icon:tI(a.icon)})})}):null]})},tN=()=>{var e=p(aT);if(!e)throw Error("Please use the hook inside the ChatPanelsToastContext context provider");return e},t_={__key:28710699928632,id:"1a1cbb120c38cd2e",loc:{},definitions:[]},tS={__key:96006977412143,id:"57515dc8dc2fede0",loc:{},definitions:[]},tM={__key:0xb78424f169b1,id:"b78424f169b142df",loc:{},definitions:[]},tk={__key:0x8786e16fbe96,id:"8786e16fbe962d09",loc:{},definitions:[]},tR={__key:26039558715119,id:"17aecea5b6efc6dc",loc:{},definitions:[]},tP={__key:2514373530611,id:"02496c5753f34af4",loc:{},definitions:[]},tA=e=>{var a=S.useConstantIncrementCallback(1),t=S.useIncrementCallback(aI,M.M);return u(e=>{var r=0,n=!1;e.forEach(e=>{e?.content?.forEach(e=>{e?.__typename==="TravelChatManager_LocationList"&&(r+=e.locations.length),e?.__typename==="TravelChatManager_Text"&&e?.link?.anchorText&&(n=!0)})}),r>0?(t(r),a(aI,M.LOCATIONSELECTION),a(aI,M.TAG),a(aI,M.LK),a(aI,M.LOCALIZATION)):n&&a(aI,M.LOCALIZATION)},[a,t,e])},tw=({threadId:e,messageId:a,limit:t,mostRecentFirst:r=!1},n=!1)=>{var i=Q()||"",o=ea(),s=h(()=>({userId:i,threadId:e,messageId:a,limit:t,currency:o,tagCategories:ay}),[i,e,a,t,o]),[{data:l,fetching:c,error:u},m]=Z({query:tR,variables:s,pause:n,requestPolicy:"network-only"}),p=tA("useMessages");return d(()=>{var e=l?.TravelChatManager_getMessages?.messages;!c&&!n&&e?.length&&p(e.map(e=>e?.__typename==="TravelChatManager_AssistantMessage"?e:null).filter(Boolean))},[l,c,s,n,p]),[{data:h(()=>{if(l){var e=l.TravelChatManager_getMessages?.messages||null;return{messages:!e||r?e:[...e].reverse(),nextMessageId:l?.TravelChatManager_getMessages?.nextMessageId||null}}},[l,r]),fetching:c,error:u},m]},tL=()=>{var e=Q()||"",{languageTag:a,geoId:t,locationId:r,pageName:n,currency:i}=_(),[{fetching:o},s]=X(tS),l=tA("useSendMessage");return{sendMessage:u(({threadId:o,text:d,response:c,userId:u})=>s({userId:u??e,threadId:o,responseContent:c,text:d,geoId:t,languageTag:a,locationId:r,pageName:n,localTime:new Date().toISOString(),currency:i,tagCategories:ay}).then(e=>{var a=e.data?.TravelChatManager_addMessage?.reply;return l(a?[a]:[]),e}),[s,e,t,a,r,n,i,l]),fetching:o}},tO=()=>{var e=Q()||"",a=ea(),[{fetching:t,error:r},n]=X(tM);return{cancelPendingMessage:u(({threadId:t,messageId:r})=>n({userId:e,threadId:t,messageId:r,currency:a,tagCategories:ay}),[n,e,a]),fetching:t,error:r}},tD=()=>{var e=Q()||"",[{fetching:a},t]=X(t_);return{addFeedback:u(({threadId:a,messageId:r,rating:n,customFeedback:i})=>t({userId:e,threadId:a,messageId:r,rating:n,customFeedback:i}),[t,e]),fetching:a}},tB=({threadId:e,limit:a},t=!1)=>{var r=Q()||"",n=h(()=>({userId:r,threadId:e,limit:a}),[r,e,a]);return Z({query:tP,variables:n,pause:t,requestPolicy:"network-only"})},tQ=()=>{var e=Q()||"",[a,t]=X(tk);return{deleteThreads:u(a=>t({userId:e,threadId:a}),[t,e]),state:a}},tz=e=>{for(var a=e.slice(),t=a.length-1;t>0;t--){var r=Math.floor(Math.random()*(t+1));[a[t],a[r]]=[a[r],a[t]]}return a},tx={optionsContainer:"oNVYt Rd Gi",optionsHeader:"zVilR f MI",optionsHeaderContent:"P",thumbsContainer:"NM Nk",freeFormContainer:"yJRrg",freeFormSubmitContainer:"gOmiR f",votingThumbsContainer:"XlDrI f",votedThumbsContainer:"edJMz Ci"},tH=({disabled:e,onSubmit:a})=>{var[t,r]=l(""),o=c(null),s=c(null);return d(()=>{s.current?.scrollIntoView({behavior:"smooth",block:"end"}),o.current?.focus()},[]),n("form",{ref:s,onSubmit:e=>{e.preventDefault(),a(t.trim())},children:[i(ed,{value:t,onChange:e=>r(e.target.value),"aria-label":aE.feedback.inputAriaLabel,placeholder:aE.feedback.feedbackPlaceholder,maxLength:160,ref:o}),i("div",{className:tx.freeFormSubmitContainer,children:i(K,{type:"submit",disabled:e,variant:"primary",children:aE.feedback.submitButton})})]})},tW=({feedbackRating:e,disabled:a,onSelect:t,onClose:r})=>{var o=c(null);d(()=>{o.current?.scrollIntoView({behavior:"smooth",block:"nearest"})},[]);var s=e=>{t({isFlowComplete:"OTHER"!==e,rating:e})},l="OTHER"===e,u=[...h(()=>tz(Object.entries(aC).slice(0,4)),[]),...Object.entries(aC).slice(4)];return n("div",{className:tx.optionsContainer,ref:o,children:[n("div",{className:tx.optionsHeader,children:[i("div",{id:"feedbackOptionsLabel",className:tx.optionsHeaderContent,children:i(G,{atlasVariant:"fixed-label-30",children:aE.feedback.thumbsDownTitle})}),i(q,{type:"button",variant:"clear",size:"small",icon:eo,onClick:r,"aria-label":aE.feedback.closeAriaLabel})]}),i(es,{name:"feedbackOptions",ariaLabelledBy:"feedbackOptionsLabel",children:u.map(([t,r])=>i("div",{children:i(el,{value:t,selected:e===t,onSelect:()=>s(t),label:r,disabled:a,alignItems:"center"},t)},t))}),l&&i("div",{className:tx.freeFormContainer,children:i(tH,{onSubmit:a=>{l&&t({isFlowComplete:!0,rating:e,message:a.trim()})},disabled:a})})]})},tV=({disabled:e,onThumbsUp:a,onThumbsDown:t,feedbackRating:r})=>r?i("div",{className:tx.votedThumbsContainer,children:"GOOD"===r?i(ei,{size:20,ariaAttributes:{"aria-label":aE.feedback.votedThumbsUpAriaLabel},"data-automation":"aitaThumbsUp"}):i(en,{size:20,ariaAttributes:{"aria-label":aE.feedback.votedThumbsDownAriaLabel},"data-automation":"aitaThumbsDown"})}):n("div",{className:tx.votingThumbsContainer,children:[i(q,{variant:"primary",icon:W,size:"small",onClick:e?void 0:a,"aria-label":aE.feedback.voteThumbsUpAriaLabel,dataAttributes:{"data-automation":"aitaThumbsUp"}}),i(q,{variant:"primary",icon:H,size:"small",onClick:e?void 0:t,"aria-label":aE.feedback.voteThumbsDownAriaLabel,dataAttributes:{"data-automation":"aitaThumbsDown"}})]}),tK=({feedbackRating:e,onFeedback:a,isOnFeedbackFetching:t})=>{var[r,o]=l(e),[s,d]=l(!1),{openToast:c}=tN(),u=e=>c({textContent:aE.feedback["GOOD"===e?"thanksGood":"thanksBad"],variant:"primary",icon:"GOOD"===e?"thumbsUp":"thumbsDown",isDurationLong:!0}),h=e=>{if(!t){var n=e.rating;a(n,e.message).then(a=>{if(!a.ok){c({textContent:aE.feedback.error,variant:"error",icon:"error"});return}e.isFlowComplete&&u(n),n!==r&&o(n),d("GOOD"!==n&&!e.isFlowComplete)})}};return n("div",{children:[i("div",{className:tx.thumbsContainer,children:i(tV,{feedbackRating:r,disabled:t,onThumbsUp:()=>{h({rating:"GOOD",isFlowComplete:!0})},onThumbsDown:()=>{h({rating:"BAD",isFlowComplete:!1})}})}),s&&i(tW,{feedbackRating:r,disabled:t,onSelect:h,onClose:()=>{u("BAD"),d(!1)}})]})},tq=({feedbackRating:e,threadId:a,messageId:t})=>{var{addFeedback:r,fetching:n}=tD(),o=R(),s=P();return i(aN,{feedbackRating:e,onFeedback:async(e,n)=>{o({itemType:"aitaMessage",actionSubType:"rateMessage",threadId:a,messageId:t,feedbackRating:e});var i=await r({threadId:a,messageId:t,rating:e,customFeedback:n});return s({requestName:"addFeedback",error:i.error,hasData:!!i.data}),{ok:!i.error}},isOnFeedbackFetching:n})},tY={__key:0x6a2e91e745a9,id:"6a2e91e745a9d275",loc:{},definitions:[]},tG={__key:26084922600521,id:"17b95e8bac499cc5",loc:{},definitions:[]},tj="RpcvS Gi B1 Z BF Cj z Pk PY Pw PK f e",tF="wJnKA f",tU=({threadId:e,messageId:a,locationId:t,postId:r,userProfile:o,forumName:s,topicTitle:l,url:d,body:c,snippets:u})=>{var h={itemType:"aitaForumPostCard",threadId:e,messageId:a,locationId:t,itemId:`${r}`},m=A(h),p=R(),g=n("div",{className:tF,children:[i(G,{color:"onSurface",atlasVariant:"fixed-body-10",lineClamp:1,children:s}),n("span",{"aria-hidden":!0,children:[i(G,{color:"onSurface",atlasVariant:"fixed-body-10",elementType:"span",children:"•\xa0"}),i(ep,{size:14,color:"inherit"})]})]});return n("div",{ref:m,className:tj,...ef("aitaSourceCard"),children:[n("div",{className:"HIEXR f e",children:[i(eg,{variant:"two-line",profileInfo:[o],additionalInfo1:g}),i(G,{atlasVariant:"fixed-label-20",color:"onSurface",lineClamp:2,children:l}),i(G,{atlasVariant:"fixed-body-20",color:"onSurface",lineClamp:8,children:u.length?u[0]:c})]}),i(Y,{href:d,target:"_blank",onClick:()=>p({...h,actionSubType:"clickSeeFullForumPost"}),variant:"primary-small",...ef("aitaSeeFullForumPost"),children:aE.chat.seeFullForumPost})]})},tZ=({threadId:e,messageId:a,locationId:t,reviewId:r,userProfile:o,publishedDate:s,rating:l,url:d,snippets:c})=>{var u={itemType:"aitaReviewCard",threadId:e,messageId:a,locationId:t,itemId:`${r}`},h=A(u),m=R(),p=et(),g=`${p.formatDate("date_medium_month_year",s)}`,{contributionCount:f}=o,v=n("div",{className:tF,children:[i(G,{color:"onSurface",atlasVariant:"fixed-body-10",children:g}),i(G,{color:"onSurface",atlasVariant:"fixed-body-10",children:"•"}),i(G,{color:"onSurface",atlasVariant:"fixed-body-10",children:p.formatNumber("integer",f)}),i(eT,{size:14,ariaAttributes:{"aria-hidden":!0}})]});return n("div",{ref:h,className:tj,...ef("aitaSourceCard"),children:[n("div",{children:[i(eg,{variant:"two-line",profileInfo:[o],additionalInfo1:v}),i("div",{className:"Mk MI",children:i(ev,{showRating:!1,size:"small",rating:l})}),i("div",{children:i(G,{atlasVariant:"fixed-body-20",color:"onSurface",lineClamp:8,children:c.length&&c[0]})})]}),i(Y,{href:d,target:"_blank",onClick:()=>m({...u,actionSubType:"clickSeeFullReview"}),variant:"primary-small",...ef("aitaSeeFullReview"),children:i(J,{id:"gai_review_summary_see_full_reviews",messages:"See full review"})})]})},tX={sourceShelfContainer:"Zb Px",scrollableContainer:"_T",sourceShelfScrollable:"zfJeQ _e",sourceShelf:"udkmU f",loadingContainer:"JvoYC f j u e",hasForumPosts:"bzFhD"},tJ=({threadId:e,messageId:a,locationId:t,reviewSnippets:r,forumPostSnippets:o})=>{var[s,u]=l(!1),h=c(null),m={itemType:"aitaSourcesCta",threadId:e,messageId:a,locationId:t},p=A(m),g=R();d(()=>{s&&h.current?.scrollIntoView({behavior:"smooth",block:"nearest"})},[s]),t$(s,r.size,o.size);var f=r.size+o.size,v=f>1?aE.chat.showSources:aE.chat.showSource;return s&&(v=f>1?aE.chat.hideSources:aE.chat.hideSource),n("div",{ref:p,children:[i(Y,{variant:"primary",onClick:()=>{u(!s),g({...m,actionSubType:s?"collapseSources":"expandSources"})},icon:s?eu:ec,trailing:!0,"aria-expanded":s,automationId:"aitaShowSources",children:i(G,{atlasVariant:"fixed-label-20",children:v})}),s&&i("div",{className:tX.sourceShelfContainer,style:{width:`${266*f-16}px`},ref:h,children:i(t3,{threadId:e,messageId:a,locationId:t,reviewSnippets:r,forumPostSnippets:o})})]})},t$=(e,a,t)=>{var[r,n]=l(!1),i=S.useConstantIncrementCallback(1),o=S.useConstantIncrementCallback(2),s=S.useConstantIncrementCallback(3);d(()=>{!r&&e&&(a&&(i(ak,M.UR),i(ak,M.G)),t&&i(ak,M.F2),(a||t)&&(i(ak,M.LK),i(ak,M.M),a?s(ak,M.MEM):o(ak,M.MEM)),n(!0))},[r,e,a,t,i,o,s])},t0=e=>{var{maxWidth:a,maxHeight:t,urlTemplate:r}=e?.photoSizeDynamic??{};return a&&t&&r?{maxWidth:a,maxHeight:t,urlTemplate:r}:void 0},t1=e=>{var a=Array.from(e.keys()),t=!a.length,[{data:r,fetching:n,error:i},o]=Z({query:tG,variables:{reviewIds:a},pause:t}),s=h(()=>(r?.reviews??[]).filter(Boolean).map(a=>{var{id:t,userProfile:r,publishedDate:n,rating:i,url:o}=a,s=n?new Date(n):null;return t&&r?.displayName&&r?.contributionCounts?.sumAllUgc!=null&&s&&!isNaN(s.valueOf())&&i&&o?{reviewId:t,userProfile:{displayName:r?.displayName,avatarSource:t0(r?.avatar),contributionCount:r?.contributionCounts?.sumAllUgc},publishedDate:s,rating:i,url:o,snippets:e.get(t)??[]}:null}).filter(Boolean),[r?.reviews,e]);return w({requestName:"getReviews",fetching:n,error:i,hasData:!!s.length,isQueryPaused:t}),{reviews:s,fetching:n,error:i,reexcuteReviewsQuery:()=>o({requestPolicy:"network-only"})}},t2=e=>{var a=Array.from(e.keys()),t=!a.length,[{data:r,fetching:n,error:i},o]=Z({query:tY,variables:{forumPostIds:a},pause:t}),s=h(()=>(r?.posts??[]).filter(Boolean).map(a=>{var{id:t,userProfile:r,forumName:n,topicTitle:i,body:o,url:s}=a;return t&&r?.displayName&&n&&i&&o&&s?{postId:t,userProfile:{displayName:r?.displayName,avatarSource:t0(r?.avatar)},forumName:n,topicTitle:i,body:o,url:s,snippets:e.get(t)??[]}:null}).filter(Boolean),[r?.posts,e]);return w({requestName:"getForumPosts",fetching:n,error:i,hasData:!!s.length,isQueryPaused:t}),{forumPosts:s,fetching:n,error:i,reexcuteForumsQuery:()=>o({requestPolicy:"network-only"})}},t4=(e,a)=>{var t="";return a?.networkError?t=" - network error":a?.graphQLErrors&&(t=" - gql errors"),`(ids: ${e.size?Array.from(e.keys()).join(", "):"none"}${t})`},t3=({threadId:e,messageId:a,reviewSnippets:t,forumPostSnippets:r,locationId:o})=>{var{scrollContainerProps:s,scrollButtonsProps:l}=tm(10,!1,{itemWidth:("MOBILE"===y()?230:250)+16}),{reviews:u,fetching:h,error:m,reexcuteReviewsQuery:p}=t1(t),{forumPosts:g,fetching:f,error:v,reexcuteForumsQuery:T}=t2(r),b=h||f,I=c(null);d(()=>{b||I.current?.scrollIntoView({behavior:"smooth",block:"nearest"})},[b]);var C=!b&&!u.length&&!g.length;return(d(()=>{C&&console.error(`AITA: Failed to fetch reviews ${t4(t,m)} and/or forum posts ${t4(r,v)} for thread id ${e} and message id ${a}`)},[C,t,m,v,r,e,a]),b)?i("div",{className:E(tX.loadingContainer,r.size&&tX.hasForumPosts),children:i(eh,{variant:"large"})}):C?i(ag,{errorBody:aE.chat.sourcesErrorBody,retry:()=>{p(),T()},retryButtonTitle:aE.chat.sourcesErrorCta}):n("div",{ref:I,children:[i("div",{className:tX.scrollableContainer,children:n("div",{className:tX.sourceShelfScrollable,...s,children:[n("div",{className:tX.sourceShelf,children:[u.map(t=>{var{reviewId:r,userProfile:n,publishedDate:s,rating:l,url:d,snippets:c}=t;return i(aM,{threadId:e,messageId:a,locationId:o,reviewId:r,userProfile:n,publishedDate:s,rating:l,url:d,snippets:c},`review-${r}`)}),g.map(t=>{var{postId:r,userProfile:n,forumName:s,topicTitle:l,body:d,url:c,snippets:u}=t;return i(aS,{threadId:e,messageId:a,locationId:o,postId:r,userProfile:n,forumName:s,topicTitle:l,body:d,url:c,snippets:u},`forum-post-${r}`)})]}),i(ah,{...l,iconVariant:"chevron",showOnTablet:!0,shortShadows:!0,minimizeShadowBlur:!0})]})}),!!u.length&&i(em,{marginTop:"spacing-02",tooltipVariant:"bottom-caret",includeHamonLawLocales:!0,openLinksInNewTab:!0})]})},t6=({threadId:e,messageId:a,locationId:t,sources:r})=>{var n=new Map,o=new Map;if(r.filter(Boolean).forEach(e=>{"TravelChatManager_ReviewList"===e.__typename?e.reviews.filter(Boolean).forEach(e=>{var{review_id:a,snippets:t}=e,r=t.filter(Boolean);r.length&&!n.has(a)&&n.set(a,r)}):"TravelChatManager_ForumList"===e.__typename&&e.posts.filter(Boolean).forEach(e=>{var{post_id:a,snippets:t}=e,r=t.filter(Boolean);o.has(a)||o.set(a,r)})}),n.size+o.size<1)return null;var s=new Map,l=new Map;for(var d of n.entries()){if(5===s.size)break;var[c,u]=d;s.set(c,u)}for(var h of o.entries()){if(s.size+l.size===5)break;var[m,p]=h;l.set(m,p)}return i(aR,{threadId:e,messageId:a,locationId:t,reviewSnippets:s,forumPostSnippets:l})},t9=e=>{if(!e?.details)return!1;var{placeType:a,isGeo:t,locationId:r,name:n,route:i}=e.details;return!!a&&null!=t&&null!=r&&!!n&&!!i?.url},t7=(e,a)=>"COMPLETE"===e&&!a.link,t5=()=>u((e,a)=>t7(e,a),[]),t8=e=>{var a=[];return e.forEach(e=>{if(e.responseData?.__typename==="TravelChatManager_AssistantMessage"){var t=e.responseData?.content?.find(e=>e?.__typename==="TravelChatManager_LocationList");t&&(a=[...a,...t.locations])}}),a.filter(e=>!!t9(e))},re=e=>"ERROR"===e||"TIMEOUT"===e,ra=e=>{if(!e)return null;var a=e?.__typename==="TravelChatManager_AssistantMessage",t=!(a&&(e?.status==="COMPLETE"||e?.status==="PENDING"||e?.status==="CANCELED"));return{id:e?.messageId,sender:e?.__typename==="TravelChatManager_UserMessage"?"user":"agent",responseData:e,isCancel:a&&e?.status==="CANCELED",isError:t}},rt=({threshold:e,scrollAdjustment:a=10})=>{var t=c(null),[r,n]=l(!1),[i,o]=l(!1),s=$(),d=u(a=>{var r=()=>{a&&(n(s?a.scrollLeft<=-e:a.scrollLeft>=e),o(a.scrollWidth>a.clientWidth+(s?-a.scrollLeft:a.scrollLeft)+e))};t.current&&t.current.removeEventListener("scroll",r),r(),a&&(a.addEventListener("scroll",r),t.current=a)},[e,s]),h=u(()=>{if(t.current){var e=t.current.children[0];if(e instanceof HTMLElement){var r=e.offsetWidth+a;t.current.scrollBy({left:s?-r:r,behavior:"smooth"})}}},[s,a]);return[d,u(()=>{if(t.current){var e=t.current.children[0];if(e instanceof HTMLElement){var r=e.offsetWidth+a;t.current.scrollBy({left:s?r:-r,behavior:"smooth"})}}},[s,a]),h,r,i]};function rr({location:e,lineClamp:a}){var t=et(),{detail:r}=e,n=null,o=null;if(r?.__typename==="Hotel"&&(n=r.priceRange?.minimum??null,o=r.priceRange?.maximum??null),!n||!o)return null;var s=`${t.formatCurrencyInteger(n)} - ${t.formatCurrencyInteger(o)}`;return i(G,{display:"inline-block",atlasVariant:"fixed-body-20",color:"onSurfaceVariant",lineClamp:a,children:i(J,{id:"trips_hotel_price_dated",args:{price:i(G,{atlasVariant:"fixed-label-20",elementType:"span",color:"onSurface",children:s})},messages:"{price} per night"})})}var rn=e=>{switch(e){case"HOTEL":return 1;case"BB":return 2;case"OTHER":return 3;case"COLLAPSED_BB_INN":return 99;case"VR":return 6;default:return 0}};function ri({location:e,lineClamp:a}){var{popIndexRank:t,popIndexTotal:r}=e?.popIndexDetails??{};return e?.accommodationCategory&&t&&r?i(G,{atlasVariant:"fixed-body-20",color:"onSurfaceVariant",lineClamp:a,children:i(er,{id:"common_n_of_n_lodgingtype_in_geo_pl",args:{1:t,2:r,3:rn(e?.accommodationCategory),4:e?.geoName},messages:"#{1,number,integer} of {2,number,integer} {3, select, 1 {hotels} 2 {B&Bs / Inns} 3 {Specialty lodging} 6 {Vacation rentals} other {}} in {4}"})}):null}var ro=({location:e})=>{var a=e.locationV2?.names?.longOnlyHierarchyTypeaheadV2;return a?i(eQ,{content:a,icon:eB}):null};function rs({lineClamp:e,tagsInfo:a}){var t=a?.reduce((e,a)=>a?.localizedName&&244===a.categoryId&&(e.push(a.localizedName),e.length>=2)?e.slice(0,2):e,[])?.join(", ");return t?i(G,{atlasVariant:"fixed-body-20",color:"onSurfaceVariant",lineClamp:e,children:t}):null}function rl({location:e,lineClamp:a}){var{localize:t}=ee(),r=et(),{popIndexRank:n,popIndexTotal:o}=e.popIndexDetails||{};return n&&o&&e.geoName?i(G,{atlasVariant:"fixed-body-20",color:"onSurfaceVariant",lineClamp:a,dataAttributes:{"data-automation":"flyout-attraction-ranking"},children:i(J,{id:"trips_v2_fly_out_ranking_4",args:{position:r.formatNumber("integer",n),total:r.formatNumber("integer",o),locationType:t.string("things to do","trips_v2_fly_out_ranking_things_to_do"),locationName:e.geoName},messages:"#{position} of {total} {locationType} in {locationName}"})}):null}function rd({link:e}){return e?n("div",{className:"f Q1",children:[i(eV,{size:16,color:"primaryIcon"}),i(F,{theme:"inline",href:e,target:"_blank",children:i(G,{elementType:"span",atlasVariant:"fixed-body-20",color:"inherit",children:i(J,{id:"restaurants_contact_links_menu",messages:"Menu"})})})]}):null}function rc({location:e,menu:a,lineClamp:t}){var r,{localize:s}=ee(),l=s("Restaurant","common_Restaurant_3dd"),d=e.cuisines?.reduce((e,a)=>(a?.localizedName&&e.length<2&&e.push(a.localizedName),e),[])||[],c=e.price?.[0]?.localizedName??null,u=c?d.concat(c):d;return a?.menuUrl?r=a.menuUrl:a?.hasProvider&&e.route?.url&&(r=`${e.route.url}#menu`),n("div",{className:ex("_W K Q1",eH({lineClamp:t})),children:[n(G,{elementType:"span",atlasVariant:"fixed-body-20",color:"onSurfaceVariant",display:"flex",children:[i(ez,{size:16,marginRight:"spacing-01"}),l]}),u.length>0?" • ":null,u.map((e,a)=>n(G,{elementType:"span",atlasVariant:"fixed-body-20",color:"onSurfaceVariant",children:[e,a<u.length-1?" • ":""]},e)),r?n(o,{children:[" • ",i(rd,{link:r})]}):null]})}function ru({lineClamp:e,tagsInfo:a}){var t=eK(a?.map(e=>e?.tagId).filter(Boolean)??[]),r=a?.find(e=>e?.tagId===t),n=r?.localizedName||a?.[0]?.localizedName;return n?i(G,{atlasVariant:"fixed-body-20",color:"onSurfaceVariant",lineClamp:e,children:n}):null}function rh({location:e,lineClamp:a}){var t=et(),r=e.locationV2?.details,n=r?.__typename==="LocationSelection_AttractionProductDetails"?{price:r?.productDetails?.pricingInfo?.fromPrice??null,isTieredPricing:r?.productDetails?.pricingInfo?.isTieredPricing??!1,isPerGroupPricing:r?.productDetails?.pricingInfo?.pricingType==="UNIT",flexibleDisplayDuration:r?.productDetails?.displayDuration?.__typename==="ExpPresentationService_FlexibleDisplayDuration"?r?.productDetails?.displayDuration:null}:null;return n?.price?i(G,{atlasVariant:"fixed-body-20",color:"onSurfaceVariant",lineClamp:a,children:i(eq,{price:i(G,{atlasVariant:"fixed-label-20",display:"inline-block",elementType:"span",color:"onSurface",children:t.formatCurrency(n.price)}),isTieredPricing:n.isTieredPricing,isPerGroupPricing:n.isPerGroupPricing})}):null}var rm=({location:e,tagsInfo:a})=>{if(e.isGeo)return i(aA,{location:e});var t=e.locationV2?.tags?.tags?.find(e=>e?.tagId===11066);switch(e.placeType){case"ACCOMMODATION":return i(rp,{location:e});case"EATERY":return i(rg,{location:e});case"ACTIVITY":return i(rf,{location:e,tagsInfo:a});case"ATTRACTION":if(t)return i(rT,{location:e,tagsInfo:a});return i(rv,{tagsInfo:a});default:return null}},rp=({location:e})=>n(o,{children:[i(ri,{location:e,lineClamp:1}),i(rr,{location:e,lineClamp:1})]}),rg=({location:e})=>i(rc,{location:e,lineClamp:1}),rf=({location:e,tagsInfo:a})=>n(o,{children:[i(ru,{lineClamp:1,tagsInfo:a}),i(rh,{location:e,lineClamp:1})]}),rv=({tagsInfo:e})=>i(rs,{lineClamp:1,tagsInfo:e}),rT=({location:e,tagsInfo:a})=>n(o,{children:[i(rs,{lineClamp:1,tagsInfo:a}),i(rl,{location:e,lineClamp:1})]}),rb={container:"WiXwJ z I W _X",card:"IdRsz Cj Gi Re o",imageContainer:"YdkBi I",info:"kKjNx e Q1"},rE={buttonsContainer:"DJYdd u f k l _Q w",filler:"f H",previousButton:"iTdnw NL",nextButton:"vswka Nj"},ry=({scrollBack:e,scrollForward:a})=>{var{localize:t}=ee();return n("div",{className:rE.buttonsContainer,children:[e&&i("div",{className:rE.previousButton,children:i(q,{"aria-label":t.string("Previous","common_Previous"),variant:"primary-border",icon:eb,onClick:e,automationId:"aitaMapCarouselPrevious"})}),i("div",{className:rE.filler}),a&&i("div",{className:rE.nextButton,children:i(q,{"aria-label":t.string("Next","common_Next"),variant:"primary-border",icon:eE,onClick:a,automationId:"aitaMapCarouselNext"})})]})},rI=({threadId:e,messageId:a,locations:t,listElementsRef:r,listContainerRef:s,onCardChange:l,tagsInfoMap:d})=>{var{selectMarker:h}=ek(),m=c(null),p=c(!1),[g,f,v,T,b]=aP({threshold:100}),E=e=>{if(!e)return!1;var a=e.getBoundingClientRect(),t=s.current?.getBoundingClientRect();return a.left>=(t?.left??0)&&a.right<=(t?.right??0)},y=u((e,a)=>{a&&l?.(e),h?.(e)},[h,l]),I=c(ew(()=>{var e=(m.current?.scrollLeft??0)>100,a=p.current||e;for(var[t,n]of r.current??new Map)if(E(n)){y(String(t),a),p.current=!0;break}},30));return n(o,{children:[i("div",{className:"EsGyW Q2 _t q",ref:e=>{m.current=e,g(e)},onScroll:I.current,"data-automation":"aita_map_item_carousel",children:t.map((t,n)=>i(aL,{index:n,threadId:e,messageId:a,ref:e=>{r&&"function"!=typeof r&&t?.details?.locationId&&(e?r.current?.set(String(t?.details?.locationId),e):r.current?.delete(String(t?.details?.locationId)))},location:t?.details||null,locationReviewSummary:t?.reviewRatingAndCount||null,tagsInfo:d&&t?.details?.locationId?d.get(t.details.locationId):void 0},t?.details?.locationId))}),i("div",{className:"JqoPO u S t w _Z",children:i(aO,{scrollBack:T?f:void 0,scrollForward:b?v:void 0})})]})},rC={__key:56623040765752,id:"337f943b1f38a391",loc:{},definitions:[]},rN=e=>{var a=[];return(e.forEach(e=>{var t=e?.details||null;null!==t&&null!==t.latitude&&null!==t.longitude&&a.push(new e_(t.latitude,t.longitude))}),a.length)?eS.fromArray(a):null},r_=e=>{if(e.tags?.find(e=>e?.tagId===11066))return eF;switch(e.placeType){case"ATTRACTION":return eG;case"EATERY":return eU;case"ACCOMMODATION":return ej;default:return eB}},rS=e=>"BOTB"===e?"best-of-the-best":"default",rM=({location:e,selected:a,onClick:t,onMouseEnter:r,onMouseLeave:n})=>{var o,s=h(()=>new e_(e.latitude,e.longitude),[e]),[{data:l}]=eY({query:rC,variables:{saveObjects:[{id:e.locationId?.toString(),type:"location"}]},requestPolicy:"network-only",pause:!e.locationId},{Trips_addItemReferences:()=>"invalidateAndRefetch",tripsRemoveReference:()=>"invalidateAndRefetch",Trips_createTrip:()=>"invalidateAndRefetch"}),d=u(()=>{t?.(e.locationId)},[t,e.locationId]),c=u(()=>{r?.(e.locationId)},[r,e.locationId]),m=u(()=>{n?.(e.locationId)},[n,e.locationId]);e.isGeo||(o=e.reviewSummary?.rating??void 0);var p=!!l?.Trips_isSaved?.[0];return i(eR,{markerId:`${e.locationId}`,position:s,icon:r_(e),isSaved:p,rating:o,travelersChoice:e.awardType?{variant:rS(e.awardType)}:void 0,onMouseEnter:c,onMouseLeave:m,onClick:d,markerAutomation:{automationId:a?"aitaTripMapMarkerSelected":"aitaTripMapMarker"},iconAutomation:{automationId:p?"aitaSavedPinIcon":void 0}})},rk={container:"GJQvE w _Z MJ Re o z",loadingOverlay:"DHARJ w _Z",carouselContainer:"DPaIe w Z1",zoomControl:"MsHgE"},rR=({threadId:e,messageId:a,locations:t,loading:r,onZoomChange:o,onPinClick:s,wrapperRef:m,onPanStart:p,tagsInfoMap:g,onMapNotSupported:f})=>{var v=R(),T="MOBILE"===y(),{selectMarker:b,selectedMarkerId:E}=ek(),I=c(new Map),C=c(null),[N,_]=l(null),[S,M]=l(!0),k=e=>{e&&I.current.get(e)?.scrollIntoView({behavior:"smooth",block:"nearest",inline:"center"})},P=u(t=>{M(!1),b?.(String(t)),s?.(t),t&&(k(String(t)),v({itemType:"aitaMap",actionType:"click",actionSubType:"mapLocationIconClicked",threadId:e,messageId:a,itemId:String(t)}))},[s,b,v,e,a]),A=u(e=>{!r&&e.userGesture&&o?.(e)},[r,o]),w=h(()=>t.find(e=>String(e?.details?.locationId)===E),[t,E]);d(()=>{if(N&&E&&w&&w?.details?.latitude&&w?.details?.longitude&&!S){var e=N.getBounds(),a=new e_(w.details.latitude,w.details.longitude),t=eM.getPaddedBounds(a,N.getZoom(),aQ),r=!e.containsPoint(a),n=t&&!e.containsBounds(t);(r||n)&&N.panIntoView(a,aQ)}},[N,E,w,S]);var L=h(()=>t.map(e=>e?.details?.locationId&&e.details.latitude&&e.details.longitude?{locationId:e.details.locationId,isGeo:e.details.isGeo,placeType:e.details.placeType,latitude:e.details.latitude,longitude:e.details.longitude,name:e.details.name,reviewSummary:e.reviewRatingAndCount?.responseData?{count:e.reviewRatingAndCount.responseData.count,rating:e.reviewRatingAndCount.responseData.rating}:null,awardType:e.details.locationV2?.bestAwardForActiveYearV2?.awardType,tags:e.details.locationV2?.tags?.tags}:null).filter(Boolean),[t]),O=h(()=>t.length>0?rN(t):null,[t]);return n("div",{ref:m,className:rk.container,"data-automation":"aita_map_item_map",children:[n(eA,{boundsPadding:aQ,onClick:()=>{b?.(null)},onZoomChange:A,onPanStart:p,onRenderComplete:e=>{var a=e.map,t=a.getZoom(),r=a.getMinZoom();a.setMinZoom(Math.max(t-3,r)),_(e.map);var n=L[0]?.locationId;n&&b?.(String(n))},onMapNotSupported:f,cooperativeGestures:!0,initialBounds:O,children:[!T&&!r&&i("div",{className:rk.zoomControl,children:i(eN,{variant:"Square",zoomInAutomationId:"aitaMapZoomIn",zoomOutAutomationId:"aitaMapZoomOut"})}),L.map(e=>i(aB,{selected:E===String(e.locationId),location:e,onClick:P},e.locationId)),E&&i("div",{className:rk.carouselContainer,ref:C,children:i(aD,{threadId:e,messageId:a,locations:t,listElementsRef:I,listContainerRef:C,onCardChange:r=>{S&&M(!1);var n=t.findIndex(e=>`${e?.details?.locationId}`===r);r&&n>=0&&v({itemType:"aitaMap",actionType:"click",actionSubType:"mapScrollClick",threadId:e,messageId:a,itemId:r,mapScrollDepth:n+1})},tagsInfoMap:g})})]}),r&&i("div",{className:rk.loadingOverlay})]})},rP=e=>i(eP,{children:i(rR,{...e})}),rA={__key:0xf402a892aaed,id:"f402a892aaed3e02",loc:{},definitions:[]};function rw({location:e,lineClamp:a}){var[{fetching:t,data:r}]=Z({query:rA,variables:{locationId:e.locationId||0},pause:!e.locationId});if(t)return i(eX,{width:"100%",height:"17px"});var n=r?.attraction?.[0]?.details?.recommendedVisit;return n?i(G,{atlasVariant:"fixed-body-20",color:"onSurfaceVariant",lineClamp:a,children:i(J,{id:"trips_cards_icon_content_duration",args:{sDuration:n},messages:"Duration: {sDuration}"})}):null}function rL({location:e,menu:a,tagsInfo:t}){if(!e.placeType)return null;var r=e.locationV2?.tags?.tags?.find(e=>e?.tagId===11066);switch(e.placeType){case"ACCOMMODATION":return i(rO,{location:e});case"EATERY":return i(rD,{location:e,menu:a});case"ACTIVITY":return i(rB,{location:e,tagsInfo:t});case"ATTRACTION":if(r)return i(rz,{location:e,tagsInfo:t});return i(rQ,{location:e,tagsInfo:t});default:return null}}function rO({location:e}){return n(o,{children:[i(ri,{location:e}),i(rr,{location:e})]})}function rD({location:e,menu:a}){return i(rc,{location:e,menu:a})}function rB({location:e,tagsInfo:a}){return n(o,{children:[i(ru,{tagsInfo:a}),i(rh,{location:e})]})}function rQ({location:e,tagsInfo:a}){return n(o,{children:[i(rs,{tagsInfo:a}),i(rw,{location:e})]})}function rz({location:e,tagsInfo:a}){return n(o,{children:[i(rs,{tagsInfo:a}),i(rl,{location:e})]})}var rx={card:"sNRSm Fi",stack:"JsBMk",columns:"cTOwe Fi k",saveButton:"I"};function rH({location:e,menu:a,locationReviewSummary:t,onSaveClick:r,onSaveComplete:s,onNameLinkClick:l,tagsInfo:d}){var c,u=y(),h="MOBILE"===u,m="DESKTOP"===u,p=null;e.isGeo?p=i(aA,{location:e}):t?.responseData?.rating!=null&&t?.responseData?.count!=null&&(c={rating:t.responseData.rating,reviewCount:t.responseData.count});var g=i(G,{lineClamp:2,atlasVariant:"fixed-label-30",dataAttributes:{"data-automation":"aitaRecommendationTitle"},color:"onSurface",children:e.name}),f=e.route?.url?i(F,{href:e.route?.url,theme:"standalone",target:"_blank",onClick:l,children:g}):g,v=h?n("div",{className:rx.stack,children:[n("div",{className:rx.columns,children:[n("div",{className:rx.stack,children:[f,p,c?i(ev,{size:"small",showRating:!1,rating:c.rating,reviewCount:c.reviewCount}):null]}),i("div",{className:rx.saveButton,children:i(U,{id:e.locationId,asButton:!h,roundedBackground:!h,variant:"primary-border",bookmarkStyle:"circular-button",renderLabel:h?void 0:e=>e,saveSourceOrigin:"AI_TRAVEL_ASSISTANT",onClick:r,onSaveComplete:s})})]}),i(rL,{location:e,menu:a,tagsInfo:d})]}):n(o,{children:[n("div",{className:rx.stack,children:[f,p,c?i(ev,{size:"small",showRating:!1,rating:c.rating,reviewCount:c.reviewCount}):null,i(rL,{location:e,menu:a,tagsInfo:d})]}),i("div",{className:rx.saveButton,children:i(U,{id:e.locationId,asButton:m,roundedBackground:m,variant:"primary-border",bookmarkStyle:"circular-button",renderLabel:m?e=>e:void 0,saveSourceOrigin:"AI_TRAVEL_ASSISTANT",onClick:r,onSaveComplete:s})})]});return n("div",{className:rx.card,children:[i(eL,{source:e.thumbnail?.photoSizeDynamic,width:70,height:70,roundingSize:"medium"}),v]})}var rW=({location:e,menu:a,locationReviewSummary:t,threadId:r,messageId:n,tagsInfo:o})=>{var s=Q(),{locationId:l}=e,d={itemType:"aitaLocationCard",threadId:r,messageId:n,itemId:`${l}`,isBookableAttractionProduct:e.locationV2?.details?.__typename==="LocationSelection_AttractionProductDetails"&&e.locationV2?.details?.productDetails?.pricingInfo!=null,viewType:"LIST"},c=A({...d,saveable:!0}),u=R(),h=function(e){switch(e){case"ATTRACTION":case"ACTIVITY":return"Attraction";case"EATERY":return"Restaurant";case"ACCOMMODATION":return"Hotel";default:return e}}(e.placeType);return i("div",{ref:c,className:"_T Gi","data-automation":h?`recommendationItem_${h}`:void 0,children:i(rH,{location:e,menu:a,locationReviewSummary:t,tagsInfo:o,onSaveClick:()=>u({...d,actionSubType:"clickSaveButton"}),onSaveComplete:(e,a,t)=>{u({...d,actionSubType:"saveLocationToTrip",tripId:t,tripSaveType:a}),L(s)},onNameLinkClick:()=>u({...d,actionSubType:"openLocationDetails"})})})},rV=({locations:e,threadId:a,messageId:t})=>{var r=e.map(({menu:e,details:r,reviewRatingAndCount:s,sources:l,tagsInfo:d})=>{var{locationId:c}=r,u=t6({threadId:a,messageId:t,locationId:c,sources:l});return n("li",{className:E("iBMiJ Gi Re MJ",{CuIal:!u}),children:[i(ax,{threadId:a,messageId:t,location:r,menu:e,locationReviewSummary:s,tagsInfo:d}),u?n(o,{children:[i(eZ,{marginTop:"spacing-03"}),u]}):null]},c)}).filter(Boolean);return i("ul",{children:r})},rK={tabs:"Xb MJ NB"},rq=({locationList:e,threadId:a,messageId:t,mapViewEnabled:r,tagsInfoMap:s})=>{var[d,c]=l(!0),u=R(),m=A({itemType:"aitaMap",threadId:a,messageId:t}),p=e.filter(e=>!!t9(e)).map(e=>{var{placeType:a,isGeo:t,locationId:r,name:n,route:i}=e.details,o=e.reviewRatingAndCount?.responseData?.count!=null&&null!=e.reviewRatingAndCount.responseData.rating&&e.reviewRatingAndCount.responseData.rating>=0;return{details:{...e.details,placeType:a,isGeo:t,locationId:r,name:n,route:{url:i.url}},menu:e.menu??void 0,reviewRatingAndCount:o?e.reviewRatingAndCount:null,sources:e.sources,tagsInfo:s?.size?s?.get(Number(r)):void 0}}),g=h(()=>[{state:"map",label:aE.chat.map,dataAutomation:"aitaMapRecommendationsSwitch"},{state:"list",label:aE.chat.list,dataAutomation:"aitaListRecommendationsSwitch"}],[]),[f,v]=l(g[0].state),T=h(()=>0!==p.filter(e=>e.details?.latitude!==null&&e.details?.longitude!==null).length,[p]);if(!p.length)return null;if(d&&r&&T){var b=f===g[0].state?i(O,{component:"chat_map",children:i(az,{wrapperRef:m,threadId:a,messageId:t,locations:e,tagsInfoMap:s,onMapNotSupported:()=>{c(!1)}})}):i(aH,{locations:p,threadId:a,messageId:t});return n(o,{children:[i("div",{className:rK.tabs,children:i(eC,{bordered:!0,states:g,onStateChange:e=>{v(e),u({itemType:"aitaMap",actionType:"click",actionSubType:"mapListToggle",toggleType:"map"===e?"MAP":"LIST",threadId:a,messageId:t})},activeState:f})}),b]})}return i(aH,{locations:p,threadId:a,messageId:t})},rY="egcLq",rG="ORLqq",rj=({children:e})=>i(G,{atlasVariant:"fixed-body-30",dataAttributes:{"data-automation":"aitaNarrationItem"},children:e}),rF=()=>i(rj,{children:i("span",{role:"alert",children:aE.chat.canceledMessage})}),rU=()=>aE.chat.errorMessages[Math.floor(Math.random()*aE.chat.errorMessages.length)],rZ=()=>{var e=h(()=>rU(),[]);return i(rj,{children:i("span",{role:"alert",children:e})})},rX=e=>{var a=/(?:\n|\r|\n\r|^) *$/u;return e.replace(/- /gmu,(e,t,r)=>r.substring(0,t).match(a)?e:"\\- ")},rJ=({threadId:e,messageId:a,markdownText:t})=>i(j,{overrides:{p:{props:{className:"WRgTA"}},li:{props:{className:"QKKjg NM"}},ul:{props:{className:rY}},ol:{props:{className:rY}},hr:{props:{className:rY}},a:{component:({href:t,children:r})=>t?i(r$,{href:t,threadId:e,messageId:a,children:r}):i("span",{children:r})},h1:{component:({children:e})=>i(G,{elementType:"h1",atlasVariant:"fixed-title-10",color:"inherit",marginY:"spacing-01",children:e})},h2:{component:({children:e})=>i(G,{elementType:"h2",atlasVariant:"fixed-label-30",color:"inherit",marginY:"spacing-01",children:e})},h3:{component:({children:e})=>i("h4",{className:rG,children:e})},h4:{component:({children:e})=>i("h5",{className:rG,children:e})},h5:{component:({children:e})=>i("h6",{className:rG,children:e})}},children:rX(t)}),r$=({variant:e="inline",threadId:a,messageId:t,href:r,trackedUrl:n,children:o})=>{var s={itemType:"aitaLink",threadId:a,messageId:t,itemId:n??r,linkType:"buttonBorderless"===e?"cta":"inline"},l=A(s),d=R();return"buttonBorderless"===e?i(Y,{ref:l,href:r,target:"_blank",onClick:()=>d({...s,actionSubType:"openLink"}),dataAttributes:{"data-automation":"aitaChatResponseLink"},children:o}):i(F,{ref:l,theme:"inline",href:r,target:"_blank",onClick:()=>d({...s,actionSubType:"openLink"}),"data-automation":"aitaChatResponseLink",children:o})},r0=({threadId:e,messageId:a,impression:t,markdown:r})=>i("div",{ref:A({...t,saveable:t.saveable}),children:i(rj,{children:i(rJ,{threadId:e,messageId:a,markdownText:r})})}),r1=({id:e,markdown:a,geoId:t,baseTrackingEvent:r})=>{var n=Q(),o=R();return i(U,{id:e,type:"aiassistantmessage",messageMarkdownBody:a,saveSourceOrigin:"AI_TRAVEL_ASSISTANT",predefinedLocationId:t,onClick:()=>o({...r,actionSubType:"clickTextBlockSaveButton"}),onSaveComplete:(e,a,t)=>{o({...r,actionSubType:"saveTextBlockToTrip",tripId:t,tripSaveType:a}),L(n)}})},r2=({threadId:e,messageId:a,status:t,content:r,resolvedGeoIds:o,feedbackRating:s,isMapViewEnabled:l,tagsInfoMap:d})=>{var c={sender:"agent",id:a};if("CANCELED"===t)return{...c,isPending:!1,contents:[{type:"text",content:i(rF,{})}]};if(re(t))return{...c,isPending:!1,contents:[{type:"text",content:i(rZ,{}),backgroundColor:"red"}]};var u=o?.length===1?o[0]:null,h=[];return(r??[]).forEach((o,s)=>{if(o){var c=o.__typename,m=`${a}-${s}`;switch(c){case"TravelChatManager_Text":if(r){var p=t6({threadId:e,messageId:a,sources:o.sources}),g=r4(o.link,a,e),f={itemType:"aitaTextBlock",threadId:e,messageId:a,itemId:m},v=o.content,T=t7(t,o)?i(r1,{id:m,markdown:v,geoId:u,baseTrackingEvent:f}):void 0;h.push({saveButton:T,type:"text",content:n("div",{role:"alert",children:[i(r0,{threadId:e,messageId:a,impression:{...f,saveable:!!T},markdown:v}),g,p]})})}return;case"TravelChatManager_LocationList":h.push({backgroundColor:"transparent",type:"list",content:i(aW,{threadId:e,messageId:a,locationList:o.locations,mapViewEnabled:l,tagsInfoMap:d})});return;default:console.error(`Unhandled chat message content type: ${c}`)}}}),("COMPLETE"===t||"INAPPROPRIATE_PROMPT"===t)&&h.length&&(h[h.length-1].footer=i(a_,{threadId:e,messageId:a,feedbackRating:s??void 0})),{...c,isPending:"PENDING"===t,contents:h}},r4=(e,a,t)=>{var r=e?.route?.webLinkUrl,n=e?.route?.url??void 0,o=e?.anchorText?.value;return e&&r&&o?i(r$,{variant:"buttonBorderless",href:r,trackedUrl:n,messageId:a,threadId:t,children:o}):null},r3="data-message-id",r6=({containerElement:e,assistantMessageId:a,userMessageId:t})=>{var r=(e?.scrollTop??0)+(e?.getBoundingClientRect()?.height??0),n=(e?.scrollHeight??0)-r;return!e||n>60?null:()=>{var r=t?e.querySelector(`[${r3}="${t}"]`):void 0,n=e.querySelector(`[${r3}="${a}"]`);if(n){var i=e.getBoundingClientRect().y;if(!r){var o=n.getBoundingClientRect().y-i-72;if(o<10)return;e.scrollBy({top:o,behavior:"smooth"});return}var s=r.getBoundingClientRect().y-i-72;s<0||s>e.getBoundingClientRect().height||e.scrollBy({top:s,behavior:"smooth"})}}},r9=({containerElement:e,assistantMessageId:a,userMessageId:t})=>{var r=r6({containerElement:e,assistantMessageId:a,userMessageId:t});r&&setTimeout(r,5)},r7={yes:"EKo+nCQzQkK3QA4lB9jcWaTfYEqihHNA6+sWblM0TfOAjyrsIbEtkNHprpWsMGKXVUA36dlwbwvp72Z5MyaHWw==",no:"EKo+nCQzQkK3QA4lB9jcWaTfYEqihHNA6+sWblM0TfPeE63jtwgJHhDoCL+Frrrn"},r5=e=>e.replace(/^#{1,6}\s?/gmu,"").replace(RegExp("(?:\\*\\*|__)(?<boldText>.*?)\\1","gu"),"$<boldText>").replace(RegExp("(?:\\*|_)(?<italicText>.*?)\\1","gu"),"$<italicText>").replace(/\n{2,}/gu,"\n").replace(RegExp("\\[(?<linkText>[^\\]]+)\\]\\([^)]+\\)","gu"),"$<linkText>").trim(),r8=e=>e?.some(e=>e?.__typename==="TravelChatManager_LocationList"&&e.locations.some(e=>!e?.details?.isGeo))?"RECOMMENDATIONS":e?.some(e=>e?.__typename==="TravelChatManager_Text"&&(e.link||e.content.match(/\[[^\]]+\]\([^)]+\)/u)))?"TEXT_WITH_LINK":"TEXT_ONLY",ne=e=>{var a=R(),t=aK.useConstantIncrementCallback(1),r=aq.useIncrementCallback("EKo+nCQzQkK3QA4lB9jcWaTfYEqihHNA6+sWblM0TfNfvXZcbz71bdtDNETEp7u2mvXC1F1QD1GAQ/Ftk3D3TA=="),n=aq.useIncrementCallback("EKo+nCQzQkK3QA4lB9jcWaTfYEqihHNA6+sWblM0TfNfvXZcbz71bdtDNETEp7u2e0NTaHthS2OXssxKll5TzQ=="),i=aq.useIncrementCallback("EKo+nCQzQkK3QA4lB9jcWaTfYEqihHNA6+sWblM0TfNfvXZcbz71bdtDNETEp7u2ErxijeWU05OEv3RbyJAjq/jsfto8jASOk79+ZWECu3Q="),o=aq.useIncrementCallback("EKo+nCQzQkK3QA4lB9jcWaTfYEqihHNA6+sWblM0TfNfvXZcbz71bdtDNETEp7u2jPA2HCMlQO4iMsQnWJsppU+Q+LqZZ8ZlPLI7SPLeTp4="),s=aq.useIncrementCallback("EKo+nCQzQkK3QA4lB9jcWaTfYEqihHNA6+sWblM0TfNfvXZcbz71bdtDNETEp7u2C8w6YwozyLN+aqlWTRTWkX6pA4b4zODuYL/AURXsmuU="),l=aq.useIncrementCallback("EKo+nCQzQkK3QA4lB9jcWaTfYEqihHNA6+sWblM0TfNfvXZcbz71bdtDNETEp7u2ant5d7sB0ZbWI5b6tWQzjlKPVeBEGE0fAIjRYYWsU/Y="),d=aq.useIncrementCallback("EKo+nCQzQkK3QA4lB9jcWaTfYEqihHNA6+sWblM0TfNfvXZcbz71bdtDNETEp7u2KoreqLBSPNumuAk6b0SAnq/0coHBIy8Ky4FFPHott5k="),c=aq.useIncrementCallback("EKo+nCQzQkK3QA4lB9jcWaTfYEqihHNA6+sWblM0TfNfvXZcbz71bdtDNETEp7u2SY/UpGjfIFzRF7h1B6Dsew=="),m=aq.useIncrementCallback("EKo+nCQzQkK3QA4lB9jcWaTfYEqihHNA6+sWblM0TfNfvXZcbz71bdtDNETEp7u2ifQyq41qiG+v6tgn+Znxi9dbcJM+4aYNLzD0DLM1N7c="),p=aq.useIncrementCallback("EKo+nCQzQkK3QA4lB9jcWaTfYEqihHNA6+sWblM0TfNfvXZcbz71bdtDNETEp7u2yIbEkrXdo88ME3fnfuCpE0rbKeuSVbHGD5Dvr2kx+H4="),g=aq.useIncrementCallback("EKo+nCQzQkK3QA4lB9jcWaTfYEqihHNA6+sWblM0TfNfvXZcbz71bdtDNETEp7u2PTCJYqbxmE/1tw8yYOlMVPxkWYdpewW+bHVzSqZQpIo="),f=aq.useIncrementCallback("EKo+nCQzQkK3QA4lB9jcWaTfYEqihHNA6+sWblM0TfNfvXZcbz71bdtDNETEp7u2dEO1vlbbi7o00nG/wrtoalPid4TPt1fydBZsD1kBHdo="),v=aq.useIncrementCallback("EKo+nCQzQkK3QA4lB9jcWaTfYEqihHNA6+sWblM0TfNfvXZcbz71bdtDNETEp7u2qohvUUh1SJVxHoLzmh+Stp3PeHIalM9icFKbX+Vo/sg="),T=aq.useIncrementCallback("EKo+nCQzQkK3QA4lB9jcWaTfYEqihHNA6+sWblM0TfNfvXZcbz71bdtDNETEp7u2QfE9UFK8Pe00xpa/tkofs78n8Qxcg8tUcE8+mxAmVjs="),b=aq.useIncrementCallback("EKo+nCQzQkK3QA4lB9jcWaTfYEqihHNA6+sWblM0TfNfvXZcbz71bdtDNETEp7u2kZKRR5p/OVVlahfTe6QDJvF3cuyrJiKxIsnAv6X+/vg="),E=aq.useIncrementCallback("EKo+nCQzQkK3QA4lB9jcWaTfYEqihHNA6+sWblM0TfNfvXZcbz71bdtDNETEp7u2TZU3VFp7Zb843+Af7rfAfg=="),y=aq.useIncrementCallback("EKo+nCQzQkK3QA4lB9jcWaTfYEqihHNA6+sWblM0TfNfvXZcbz71bdtDNETEp7u2ruXb3HAYaiiPXEU8ZJEQ7LTe2csLjDSYmFZI1b2oHIc="),I=aq.useIncrementCallback("EKo+nCQzQkK3QA4lB9jcWaTfYEqihHNA6+sWblM0TfNfvXZcbz71bdtDNETEp7u2XBvgBA0JMp9tr5M4K3TdG/OtV/t4HEXRZim2AIa5txs="),C=h(()=>({CANCELED:r,COMPLETE:n,INAPPROPRIATE_PROMPT:i,SEND_NETWORK_ERROR:o,SEND_INVALID_RESPONSE:s,SEND_EMPTY_RESPONSE:l,SEND_GRAPHQL_ERROR:d,SEND_TIMEOUT:c,SEND_SERVER_ERROR:m,SEND_SERVER_TIMEOUT:p,ANOTHER_PROMPT_PENDING:g,POLL_NETWORK_ERROR:f,POLL_INVALID_RESPONSE:v,POLL_EMPTY_RESPONSE:T,POLL_GRAPHQL_ERROR:b,POLL_TIMEOUT:E,POLL_SERVER_ERROR:y,POLL_SERVER_TIMEOUT:I}),[g,r,n,i,T,b,v,f,y,I,E,l,d,s,o,m,p,c]),N=t5();return u(({threadId:r,messageId:n,status:i,message:o,error:s})=>{var l=o?.some(e=>e?.__typename==="TravelChatManager_Text"&&N(i,e)||e?.__typename==="TravelChatManager_LocationList"&&e.locations.some(e=>t9(e))),d=o?o.reduce((e,a)=>a?.__typename==="TravelChatManager_Text"?e+r5(a.content).length:e,0):0,c=e.current?Date.now()-e.current:void 0;a({itemType:"aitaMessagesPanel",actionType:"other",actionSubType:"settleAssistantMessage",threadId:r,messageId:n,messageStatus:i,messageLatency:c,textLength:d,messageError:s,saveable:l,responseType:o?r8(o):void 0});var u="ERROR"===i?s:i;t(aY[u],void 0===c?r7.no:r7.yes),void 0!==c&&C[u](c)},[a,t,C,e,N])},na="TMP-ID-1-1",nt=()=>`TMP-ID-${Math.random()}-${Math.random()}`,nr=e=>e[e.length-1]?.isPending?e[e.length-1].id:void 0,nn=(e,a)=>({sender:"agent",isError:!0,isPending:!1,id:e,refetch:a}),ni=({initialThreadId:e})=>{var a=R(),t=P(),r=c(null),[n,i]=l(e),[o,s]=l(e?[]:[aj]),[h,m]=l(e?[]:[aj]),[p,g]=l(null),f=c(null),v=c(null),T=aG(v),[b,E]=l({messageId:null,pauseQuery:!0}),{sendMessage:y,fetching:I}=tL(),{cancelPendingMessage:C,fetching:N,error:_}=tO(),S=!e,[{data:M,fetching:k,error:A},L]=tw({threadId:e??"",limit:10},S);w({requestName:"getMessages",fetching:k,error:A,hasData:!!M,isQueryPaused:S});var O=!e||b.pauseQuery||!b.messageId,[D,B]=tw({threadId:e??"",limit:5,messageId:b.messageId??void 0},O);w({requestName:"getMessages",fetching:D.fetching,error:D.error,hasData:!!D.data,isQueryPaused:O});var Q=c(0),z=!n||!p?.assistantMessageId,[{data:x,fetching:H,error:W},V]=tw({threadId:n??"",limit:1,messageId:p?.assistantMessageId??""},z);w({requestName:"getMessages",fetching:H,error:W,hasData:!!x,isQueryPaused:z});var K=u((e,o={})=>{if(!f.current){Q.current=0;var l=nt();f.current=l,g(null),v.current=Date.now();var{text:d,type:c,origin:u,promptType:h,promptScrollDepth:p}=e,b=nt();s(e=>[...e,{sender:"user",id:b,rawMessage:d},{sender:"agent",id:l,isPending:!0}]),setTimeout(()=>{r.current&&r.current.scroll({top:r.current.scrollHeight,behavior:"smooth"})},5);var E=()=>K(e,{...o,isResent:!0}),I=setTimeout(()=>{f.current=null,s(e=>e.map(e=>e.id!==l?e:nn(l,E))),aV({containerElement:r.current,assistantMessageId:l,userMessageId:b}),T({threadId:n,status:"ERROR",error:"SEND_TIMEOUT"})},1e4);y({userId:o.userId,threadId:n,text:d}).then(v=>{if(clearTimeout(I),t({requestName:"addMessage",error:v.error,hasData:!!v.data}),f.current&&l===f.current){var y=v.data?.TravelChatManager_addMessage,C=y?.status,N=y?.reply,_=N?.promptMessageId,S=N?.messageId,M=N?.threadId;if(a({itemType:"aitaMessagesPanel",actionSubType:"submitMessage",threadType:void 0===n?"NEW":"EXISTING",threadId:M,messageId:_,messageType:c,messageOrigin:u,textLength:d.length,messageResent:o.isResent,promptType:h,promptScrollDepth:p,preLoginGateState:o.preLoginGateState??"LOGGED_IN"}),v.error?.networkError||!C||!N||"ANOTHER_PROMPT_PENDING"===C||!M||!S||!_){s(e=>e.map(e=>e.id!==l?e:nn(l,E))),setTimeout(()=>{r.current&&r.current.scroll({top:r.current.scrollHeight,behavior:"smooth"})},5),f.current=null;var k="SEND_INVALID_RESPONSE";v.error?.networkError?k="SEND_NETWORK_ERROR":"ANOTHER_PROMPT_PENDING"===C&&(k="ANOTHER_PROMPT_PENDING"),T({threadId:M??n,messageId:S,status:"ERROR",error:k});return}M!==n&&i(M);var R={sender:"agent",id:N.messageId,responseData:{...N,__typename:"TravelChatManager_AssistantMessage"}},P="PENDING"===N.status,A=!P&&!N.content?.length||re(N.status),w=A?nn(l,E):{...R,isPending:P};if(s(e=>e.map(e=>e.id===l?w:e.id===b?{...e,id:_}:e)),A||m([{...R,isPending:P}]),aV({containerElement:r.current,assistantMessageId:S,userMessageId:_}),f.current=P?S:null,P)g({assistantMessageId:S,userMessageId:_,userMessage:e});else{var L="SEND_EMPTY_RESPONSE";A&&("ERROR"===N.status?L="SEND_SERVER_ERROR":"TIMEOUT"===N.status?L="SEND_SERVER_TIMEOUT":v.error?.graphQLErrors&&(L="SEND_GRAPHQL_ERROR")),T({threadId:M,messageId:S,message:N.content??void 0,...A?{status:"ERROR",error:L}:{status:N.status}})}}})}},[y,n,a,T,t]);d(()=>{if(!z){var e=setTimeout(()=>{if(p.assistantMessageId===f.current){var e=p?.userMessage,a=e?()=>K(e,{isResent:!0}):null;s(e=>e.map(e=>e.id!==p.assistantMessageId?e:nn(p.assistantMessageId,a??void 0))),aV({containerElement:r.current,assistantMessageId:p.assistantMessageId,userMessageId:p.userMessageId}),T({threadId:n,messageId:p.assistantMessageId,status:"ERROR",error:"POLL_TIMEOUT"}),g(null),f.current=null}},47e3);return()=>{clearTimeout(e)}}return()=>{}},[z,T,n,p?.assistantMessageId,p?.userMessage,p?.userMessageId,K]),eJ(()=>{if(e&&!k&&!A){M?.nextMessageId&&E({messageId:M.nextMessageId,pauseQuery:!0});var a=M?.messages?.map(e=>ra(e)).filter(Boolean)||[];M?.nextMessageId||a.unshift(aj),s(a),m(a),setTimeout(()=>{r.current&&r.current.scroll({top:r.current.scrollHeight,behavior:"instant"})},0);var t=nr(a);if(t){f.current=t;var n=a[a.length-2];g({assistantMessageId:t,userMessageId:n&&"user"===n.sender?n.id:void 0,userMessage:null})}}},[e,M,k,A]),eJ(()=>{if(e&&!D.fetching&&!D.error&&D.data?.messages?.length){E({messageId:D.data.nextMessageId??null,pauseQuery:!0});var a=D?.data?.messages?.map(e=>ra(e)).filter(Boolean)||[];if(D.data?.nextMessageId||a.unshift(aj),a.length){s(e=>a.concat(e)),m(a);var t=(r.current?.scrollHeight??0)-(r.current?.scrollTop??0);setTimeout(()=>{r.current&&r.current.scroll({top:(r.current?.scrollHeight??0)-t,behavior:"instant"})},0)}}},[e,D.fetching,D.error,D.data]),d(()=>{var e=null;if(!p||H||!f.current)return()=>clearTimeout(e);var a=x?.messages?.[0],t=!a||"TravelChatManager_AssistantMessage"!==a.__typename;if((W||t)&&Q.current<=3)return Q.current++,e=setTimeout(()=>{V({requestPolicy:"network-only"})},500),()=>clearTimeout(e);var{assistantMessageId:i,userMessage:o}=p,l=o?()=>K(o,{isResent:!0}):null;if(W?.networkError||t)return s(e=>e.map(e=>e.id!==i?e:nn(i,l??void 0))),aV({containerElement:r.current,assistantMessageId:i,userMessageId:p.userMessageId}),T({threadId:n,messageId:i,status:"ERROR",error:W?.networkError?"POLL_NETWORK_ERROR":"POLL_INVALID_RESPONSE"}),g(null),f.current=null,()=>clearTimeout(e);Q.current=0;var d={id:a.messageId,sender:"agent",responseData:a},c=nn(a.messageId,l??void 0),u="PENDING"===a.status,h=!u&&!a.content?.length||re(a.status),v=h?c:{...d,isPending:u};if(s(e=>e.map(e=>e.id===i?v:e)),h||m([{...d,isPending:u}]),aV({containerElement:r.current,assistantMessageId:i}),u)e=setTimeout(()=>{V({requestPolicy:"network-only"})},500);else{var b="POLL_EMPTY_RESPONSE";h&&("ERROR"===a.status?b="POLL_SERVER_ERROR":"TIMEOUT"===a.status?b="POLL_SERVER_TIMEOUT":W?.graphQLErrors&&(b="POLL_GRAPHQL_ERROR")),T({threadId:n,messageId:i,message:a.content??void 0,...h?{status:"ERROR",error:b}:{status:a.status}}),g(null),f.current=null}return()=>clearTimeout(e)},[n,p,x,H,W,V,T,K]);var q=u(()=>{!N&&!I&&p&&n&&(a({itemType:"aitaMessagesPanel",actionSubType:"cancelPendingMessage",threadId:n,messageId:p.assistantMessageId}),C({threadId:n,messageId:p.assistantMessageId}).then(e=>{t({requestName:"cancelPending",error:e.error,hasData:!!e.data}),e.error||(f.current=null,g(null),s(e=>e.map(e=>e.id!==p.assistantMessageId?e:{sender:"agent",isCancel:!0,id:p.assistantMessageId,isPending:!1})),aV({containerElement:r.current,assistantMessageId:p.assistantMessageId,userMessageId:p.userMessageId}),T({threadId:n,messageId:p.assistantMessageId,status:"CANCELED"}))}))},[I,N,C,n,p,a,t,T]),Y=!!b.messageId,G=u(()=>{var t=!!r.current?.scrollTop&&r.current.scrollTop<200;e&&Y&&t&&b.messageId&&b.pauseQuery&&!D.fetching&&(a({actionType:"scroll",itemType:"aitaMessagesPanel",actionSubType:"pageMessages",threadId:e}),E({messageId:b.messageId,pauseQuery:!1}))},[Y,b,D.fetching,a,e]),j=u(()=>{r.current&&r.current.scroll({top:r.current.scrollHeight,behavior:"instant"})},[]);return{containerRef:r,fetching:k,error:A,reexcuteInitialMessagesQuery:L,reexcutePagedMessagesQuery:B,messages:o,currentThreadId:n,hasPendingMessage:!!nr(o),pagedMessagesError:D.error,addNewUserMessage:K,fetchingAddNewUserMessage:I,cancelPendingMessage:q,fetchingCancelPending:N,errorCancelPending:_,onScrollContainer:G,scrollToBottom:j,mostRecentMessageResponse:h}},no="UUbRM f u",ns=e=>i("svg",{...e$(e),viewBox:"0 0 7 8",children:i("path",{d:"M3.49988 0.5C3.76072 2.30875 5.1912 3.73921 7 4.00008C5.19126 4.26095 3.76078 5.69133 3.49988 7.5C3.23901 5.69137 1.80866 4.26096 0 4C1.80868 3.73903 3.23904 2.30866 3.49988 0.5Z"})}),nl=({showText:e,text:a})=>n("div",{className:"MBkjX f u",children:[n("div",{className:"fNJxz f u Cj",children:[i("div",{className:E(no,"bQQya"),children:i(ns,{size:7})}),i("div",{className:E(no,"DvZAA"),children:i(ns,{size:7})}),i("div",{className:E(no,"jAGBb"),children:i(ns,{size:7})})]}),e&&i(G,{atlasVariant:"fixed-body-20",color:"onSurfaceVariant",automationId:"aitaRecommendationsSearchInProgress",children:a||aE.chat.loadingInitialResponse})]}),nd={message:"mnYlg z w f e",inlineStart:"BWiSl",inlineEnd:"OARkt",header:"nBnEO",footer:"w",messageContainer:"tYEZx z Zb Re",redBackground:"cbTzG",transparentBackground:"AEDGb",greenBackground:"AvYmN",saveButtonContainer:"wgFmf _m",fullWidth:"w"},nc=({header:e,children:a,footer:t,orientation:r="inlineStart",backgroundColor:o,saveButton:s,fullWidth:l=!1,...d})=>n("li",{className:ex(nd.message,{[nd.inlineStart]:"inlineStart"===r,[nd.inlineEnd]:"inlineStart"!==r}),children:[e?i("div",{className:nd.header,children:e}):null,n("div",{className:ex(nd.messageContainer,{[nd.redBackground]:"red"===o,[nd.transparentBackground]:"transparent"===o,[nd.greenBackground]:"green"===o,[nd.fullWidth]:l}),children:[s?i("div",{className:nd.saveButtonContainer,children:s}):null,i("div",{className:eW(d),children:a})]}),t?i("div",{className:nd.footer,children:t}):null]}),nu=({message:e,isFirstUserMessage:a,userAvatar:t,agentAvatar:r,backgroundColors:o,threadId:s})=>{var l,{isEnabled:d}=(l=e0({experimentKeys:[tv]}),{isEnabled:l?.[tv]==="test"}),c=e.id===na,u="user"===e.sender,h=e.contents.map((a,n)=>{var s=`${e.id}-${n}`,l=u?t:r,d=u?o.user:o.agent,c=null;return"list"!==a.type&&(c=u||e.isPending?{paddingX:"spacing-03",paddingY:"spacing-02"}:{padding:["spacing-03","spacing-03","spacing-04"]}),i(aU,{fullWidth:"list"===a.type,footer:a.footer,header:0===n?l:null,orientation:u?"inlineEnd":"inlineStart",backgroundColor:a.backgroundColor??d,saveButton:a.saveButton,...c,children:a.content},s)});return n("ul",{[r3]:e.id,children:[e.isPending?i("li",{children:i(nl,{showText:a,text:e.intermediateThought})}):null,h,!d||u||c?null:i(b,{children:i(f,{children:i(aZ,{threadId:s||"thread not started yet",messageId:e.id,orientation:"inlineStart"})})})]})},nh=({prompts:e,onPromptClick:a})=>{var t=A({itemType:"aitaPrompts",arrayQuestionIds:e.map(e=>e.id??null)}),r=u((e,t)=>{a(e,t)},[a]);return 0===e.length?null:i("div",{ref:t,className:"ELIAc","aria-label":aE.chat.ariaPromptsList,role:"region",children:e.map((e,a)=>i("div",{className:"aogaM",children:i(K,{variant:"gai",size:"small",onClick:()=>r(e,a),...ef("aitaDynamicPrompt"),children:n("span",{className:"f G u Wh",children:[i("span",{className:"I",children:i(e2,{size:20,marginRight:"spacing-01"})}),e.text]})})},e.text))})},nm=({hideScrollButton:e,onClick:a})=>e?null:i("div",{className:"upLEx D _s Rb Za",children:i(q,{variant:"primary-border",size:"small",icon:ec,onClick:a,"aria-label":aE.chat.scrollDown})}),np="ZVkDM Cq Wb",ng=()=>{var{privacyPolicy:e,termsOfUse:a}=e8(),t=e5();return i("div",{className:"eJfmT Gm Re c",children:i(G,{atlasVariant:"fixed-body-10",color:"onSurface",children:i(er,{id:"ai_assistant_legal_disclaimer_v3",args:{termsLinkAttributes:`href="${a}" target="_blank" class="${np}"`,privacyLinkAttributes:`href="${e}" target="_blank" class="${np}"`,howTheSiteWorksLinkAttributes:`href="${t}" target="_blank" class="${np}"`},messages:"AI-generated; may contain inaccuracies. Don't share personal data. See <a {termsLinkAttributes}>Terms</a>, <a {privacyLinkAttributes}>Privacy &amp; Cookies Statement</a>, and <a {howTheSiteWorksLinkAttributes}>How Ollie Works</a>."})})})},nf=e=>({content:n("div",{children:[i(rZ,{}),!!e&&i("div",{children:i(Y,{onClick:e,type:"button",children:aE.chat.retrySendMessageCta})})]}),backgroundColor:"red"}),nv={__key:0xbcb404bb2efd,id:"bcb404bb2efd42c2",loc:{},definitions:[]},nT=(e,a)=>{var t=h(()=>{var a=new Set,t=new Map;return e.forEach(e=>{var r=e?.details?.locationV2?.tags?.tags?.map(e=>e?.tagId&&11066!==e.tagId?e.tagId:null)?.filter(Boolean)?.slice(0,2)||[],n=[...e?.details?.locationV2?.tags?.tags?.find(e=>e?.tagId===11066)?[11066]:[],...r];e?.details?.locationId&&(t.set(e.details.locationId,n),n.forEach(e=>a.add(e)))}),{allLocationTags:a,locationTagIdsMap:t}},[e]),[{data:r,fetching:n}]=Z({query:nv,variables:{tagIds:[...t.allLocationTags]},pause:!t.allLocationTags.size||a}),i=r?.getTagInformation;return{allLocationTagsInfoMap:h(()=>{var a=new Map;return e.forEach(e=>{if(e?.details?.locationId){var r=t.locationTagIdsMap.get(e.details.locationId)?.map(e=>{var a=i?.find(a=>a?.tagId===e);return a?{localizedName:a.localizedName,categoryId:a.categoryId,tagId:a.tagId}:null}).filter(Boolean)||[];a.set(e?.details?.locationId,r)}}),a},[e,i,t.locationTagIdsMap]),isTagInfoFetching:n}},nb=({initialThreadId:e,onSelectThread:a,initialUserMessage:t,onClose:r,onOpenThreadsPanel:s,createNewThread:c,onHasResponse:u,prompts:m})=>{var p=R(),{login:g}=B(),f=!!Q(),v=am(),{openToast:T}=tN(),[b,E]=l(new Map),{containerRef:y,messages:I,mostRecentMessageResponse:C,currentThreadId:N,hasPendingMessage:_,pagedMessagesError:S,addNewUserMessage:M,fetchingAddNewUserMessage:k,cancelPendingMessage:P,fetchingCancelPending:A,errorCancelPending:w,fetching:L,error:O,reexcuteInitialMessagesQuery:D,reexcutePagedMessagesQuery:z,onScrollContainer:x,scrollToBottom:H}=aF({initialThreadId:e}),{allLocationTagsInfoMap:W}=nT(h(()=>t8(C),[C]),_);return(d(()=>{I.length>2&&u?.()},[u,I]),d(()=>{_||E(e=>{var a=new Map(e);return W?.forEach((e,t)=>a.set(t,e)),a})},[W,E,_]),d(()=>{t?.text&&!L&&M(t)},[t,M,L]),d(()=>{w&&T({textContent:aE.chat.canceledMessageError,variant:"error",icon:"error"})},[T,w]),d(()=>{a(N||null)},[N,a]),L)?i(au,{onClose:r,onOpenThreadsPanel:s,createNewThread:c}):O?n(o,{children:[i(ac,{onClose:r,onOpenThreadsPanel:s,createNewThread:c}),i(ag,{errorBody:aE.panel.errorBody,buttonSize:"medium",retry:D,retryButtonTitle:aE.panel.errorCta,isFullScreen:!0})]}):i(a4,{ref:y,messages:I,prompts:m,isLoading:k||A,showCancelPendingButton:_,onSubmitMessage:e=>{p({itemType:"aitaMessagesPanel",actionSubType:"clickToInitiateQuery",promptScrollDepth:e.promptScrollDepth,promptType:e.promptType,threadType:N?"EXISTING":"NEW",messageType:e.type,messageOrigin:"MESSAGES_PANEL",textLength:e.text.length}),f?M(e):g({flowOrigin:"login",extraQueryParams:{contextualMessage:"ask_ollie_login_gate_header"},onClose:()=>{p({itemType:"aitaMessagesPanel",actionSubType:"cancelLoginFlow",entryPointType:e.type,promptType:e.promptType,messageOrigin:"MESSAGES_PANEL"})},onSuccess:a=>{a.userId&&M(e,{userId:a.userId,preLoginGateState:a.hasCreatedMember?"NOT_REGISTERED":"LOGGED_OUT"})}})},onCancelPendingMessage:P,onScroll:x,onScrollToBottom:H,backgroundColors:{user:"green"},onClose:r,onOpenThreadsPanel:s,createNewThread:c,pagedMessagesError:!!S,onTryLoadMore:z,threadId:N,tagsInfoMap:b,isMapViewExperimentEnabled:v.enabled})},nE=e=>e?.TravelChatManager_getThreadHeaders?.threads?.map(e=>{if(!e)return null;var{threadId:a,updatedAt:t,title:r,active:n}=e,i=new Date(t);return!r||isNaN(i.getTime())?null:{threadId:a,updatedAt:i,title:r,active:n}}).filter(Boolean)||[],ny=({isSelected:e,threadId:a,title:t,onThreadClick:r,onDeleteThread:o})=>{var s="DESKTOP"===y();return n("div",{className:E("smQnc z w k Ph PN Pu PA",{Tmmzm:e}),children:[i("button",{type:"button",onClick:()=>r(a),className:"rNDha H _S _G Hn B- C-","data-thread-id":a,children:i(G,{atlasVariant:"fixed-body-30",color:"onSurface",lineClamp:1,children:t})}),i("div",{className:"LBkfM",children:i(q,{onClick:()=>o(a),variant:s?"dark":"clear",icon:ao,"aria-label":aE.threads.deleteSessionButtonAriaLabel(t),size:"small",...ef("aitaDeleteThread")})})]})},nI={threadPanel:"eIVvQ _Z f e",horizontalMargins:"NO Nm",header:"XBCOu f k",threadPanelScroll:"CULaQ MK",newChatContainer:"UcvOV",newThreadButton:"orUOn w Ph PV Pu PA f u",threadsGroup:"SxCln",threadsGroupHeader:"yUDiM t Z1",resetButtonStyles:"SUdPB _S _G Hn B- C-"},nC=({onClose:e})=>n("div",{className:E(nI.header,nI.horizontalMargins),children:[i(G,{atlasVariant:"fixed-title-20",elementType:"h2",color:"onSurface",children:aE.threads.title}),i(q,{onClick:e,icon:eo,"aria-label":aE.threads.closeButtonAriaLabel,size:"small",automationId:"aitaCloseThreadsPanel"})]}),nN=()=>i("div",{className:"lArbl _Q X0 X1",children:i(eh,{variant:"large"})}),n_=({selectedThreadId:e,onThreadClick:a,createNewThread:t,onClose:r,initialThreadHeadersInfo:s})=>{var h=R(),{deleteThreads:m,state:p}=tQ(),g=P(),f=c(null),[v,T]=l({threadId:null,pauseQuery:!0}),[b,E]=l([]),{openToast:y}=tN(),{fetching:I,error:C,data:N,reexcuteQuery:_}=s,S=v.pauseQuery||!v.threadId,[{fetching:M,error:k,data:A},L]=tB({threadId:v.threadId??void 0,limit:30},S);w({requestName:"getThreadHeaders",fetching:M,error:k,isQueryPaused:S,hasData:!!A}),d(()=>{if(!I&&!C&&N?.TravelChatManager_getThreadHeaders){E(a6(N));var{nextThreadId:e}=N.TravelChatManager_getThreadHeaders;e&&T({threadId:e,pauseQuery:!0})}},[I,C,N]),d(()=>{if(!M&&!k&&A?.TravelChatManager_getThreadHeaders){var e=a6(A);if(e.length){E(a=>a.concat(e));var{nextThreadId:a}=A.TravelChatManager_getThreadHeaders;a&&T({threadId:a,pauseQuery:!0})}}},[M,k,A]);var O=u(()=>{if(null!==f.current){var e=f.current,a=e.scrollHeight-(e.scrollTop+e.getBoundingClientRect().height);v.threadId&&a<200&&!M&&(h({actionType:"scroll",itemType:"aitaThreadsPanel",actionSubType:"pageThreads"}),T(e=>({...e,pauseQuery:!1})))}},[v.threadId,M,h]);return I?n(o,{children:[i(nC,{onClose:r}),i(a8,{})]}):C?n(o,{children:[i(nC,{onClose:r}),i(ag,{errorBody:aE.panel.errorBody,buttonSize:"medium",retry:_,retryButtonTitle:aE.panel.errorCta,isFullScreen:!0})]}):i(a5,{ref:f,selectedThreadId:e,onScroll:O,threads:b,pagedThreadsError:!!k,onThreadClick:e=>{h({itemType:"aitaThreadsPanel",actionSubType:"openExistingThread",threadId:e}),a(e)},createNewThread:()=>{h({itemType:"aitaThreadsPanel",actionSubType:"openNewThread",lastOpenedThreadId:e}),t()},onDeleteThread:a=>{p.fetching||(h({itemType:"aitaThreadsPanel",actionSubType:"deleteThread",threadId:a}),m(a).then(r=>{g({requestName:"deleteThreads",error:r.error,hasData:!!r.data}),r.error?y({textContent:aE.threads.sessionDeletedError,variant:"error",icon:"error"}):(_(),e===a&&t(!0),y({textContent:aE.threads.sessionDeleted,variant:"primary",icon:"success",isDurationLong:!0}))}))},onTryLoadMore:L,onClose:r})},nS=({selectedThreadId:e,onThreadClick:a,createNewThread:t,onClose:r,isOpen:o,initialThreadHeadersInfo:s})=>{var{isClosed:l,slideOut:d}=ap({isOpen:o,transitionDuration:250});return l?null:i(at,{children:n("div",{className:E({vNEuT:d}),children:[i("div",{className:"suJWM _Q t s l _U Gi",onPointerDown:r}),i("div",{className:"WXoky _Q t s l _U _s o Gi",children:i(te,{selectedThreadId:e??void 0,onThreadClick:a,createNewThread:t,onClose:r,initialThreadHeadersInfo:s})})]})})},nM=()=>{var e=!Q(),[{fetching:a,error:t,data:r},n]=tB({limit:45},e);return w({requestName:"getThreadHeaders",fetching:a,error:t,isQueryPaused:e,hasData:!!r}),h(()=>{var e=a||t?void 0:r?.TravelChatManager_getThreadHeaders?.threads?.find(e=>!!e?.active);return{initialThreadHeadersFetching:a,initialThreadHeadersError:t,initialThreadHeadersData:r,reexcuteInitialThreadsQuery:n,activeThread:e}},[a,t,r,n])},nk=({onSelectThread:e,onHasResponse:a,initialUserMessage:t,onClose:r,prompts:s,isPromptsLoading:c})=>{var u=R(),{login:h}=B(),m=!!Q(),[p,g]=l(void 0),[f,v]=l(!0),[T,b]=l(!1),[E,y]=l(void 0),[I,C]=l(!1),{activeThread:N,initialThreadHeadersFetching:_,initialThreadHeadersError:S,initialThreadHeadersData:M,reexcuteInitialThreadsQuery:k}=tt();d(()=>{if(!_&&!I){var e;N?.threadId&&!t&&(e=N?.threadId,v(!1),g(N.threadId),y(N?.threadId?N.threadId:`TMP-KEY-PROP-${Math.random()}`)),u({actionType:"other",itemType:"aitaMessagesPanel",...void 0===e?{actionSubType:"autoOpenNewThread"}:{actionSubType:"autoOpenExistingThread",threadId:e}}),C(!0)}},[N,_,g,y,e,t,I,u]);var P=(e,a)=>{v(!1),b(a??!1),e&&e===p||(g(e),y(e||`TMP-KEY-PROP-${Math.random()}`))},A=()=>{u({itemType:"aitaMessagesPanel",actionSubType:"openNewThread",lastOpenedThreadId:p}),P()},w=e=>{u({itemType:"aitaMessagesPanel",actionSubType:"openThreadsPanel",lastOpenedThreadId:p,preLoginGateState:e}),k?.(),b(!0)},L=()=>{u({itemType:"aitaMessagesPanel",actionSubType:"clickToOpenThreadsPanel",lastOpenedThreadId:p}),m?w("LOGGED_IN"):h({flowOrigin:"login",extraQueryParams:{contextualMessage:"ask_ollie_login_gate_header"},onClose:()=>{u({itemType:"aitaMessagesPanel",actionSubType:"cancelLoginFlow",entryPointType:"OPEN_THREADS_PANEL_CTA",messageOrigin:"MESSAGES_PANEL"})},onSuccess:e=>w(e.hasCreatedMember?"NOT_REGISTERED":"LOGGED_OUT")})},O=!I||c,D=O?i(au,{onClose:r,onOpenThreadsPanel:L,createNewThread:A}):null,z=S?n(o,{children:[i(ac,{onClose:r,onOpenThreadsPanel:L,createNewThread:A}),i(ag,{errorBody:aE.panel.errorBody,buttonSize:"medium",retry:k,retryButtonTitle:aE.panel.errorCta,isFullScreen:!0})]}):null;return n("div",{className:"_Q t s l _U",children:[i("div",{className:"imuyB _Z Gm",children:O||S?n(o,{children:[D,z]}):i(a3,{initialThreadId:p??void 0,onSelectThread:e,initialUserMessage:f?t:void 0,onClose:r,onOpenThreadsPanel:L,createNewThread:A,onHasResponse:a,prompts:s},E)}),i(ta,{selectedThreadId:p,isOpen:T,onThreadClick:P,createNewThread:e=>P(void 0,e),onClose:()=>b(!1),initialThreadHeadersInfo:{fetching:_,error:!!S,data:M,reexcuteQuery:()=>k?.()}})]})},nR=e=>i(ab,{children:i(nk,{...e})}),nP=({children:e})=>{var{modalRef:a,status:t}=r(),n="MOBILE"===y();return"exited"===t?null:i(I,{ref:a,role:"dialog",hideBackdrop:!n,disableBlockScroll:!n,className:E("gPGsz Za f e o s _U",{TksLf:"exiting"===t||"enter"===t,pREmD:"entering"===t||"entered"===t||"exit"===t}),children:i("div",{className:"MEbqN f e Gi _Y o",children:e})})},nA=({isOpen:e,onClose:a,children:r})=>{var n="MOBILE"===y();return i(t,{isDragToDismissEnabled:n,isOpen:e,onClose:a,children:i(nP,{children:r})})},nw={ok:"rxoX9PgJuydBH0GlcDMrIIpYuv/yL8od/wC1AyPzntY=",error:"rxoX9PgJuydBH0GlcDMrIEzlXcCmwSOXO6ZNctaReCs="},nL=({isError:e})=>(ti.useIsomorphicIncrement(1,e?nw.error:nw.ok),null),nO=({error:e,errorInfo:a,onCloseChat:t})=>(console.error("[AITA] Error rendering panel:",e,"\nComponent stack:",a.componentStack),n(o,{children:[n("div",{className:"_Q l _U t s",children:[i(ac,{onClose:t}),i(ag,{errorTitle:av.errorBoundaryTitle,errorBody:av.errorBoundaryBody,isFullScreen:!0})]}),i(nL,{isError:!0})]})),nD=e=>{var[a,t]=l(!1),r=S.useConstantIncrementCallback(1);d(()=>{!a&&e&&(r(k.sender_name,M.MEM),t(!0))},[a,e,r])},nB=({isOpen:e,onSelectThread:a,onCloseChat:t,onHasResponse:r,initialUserMessage:o,prompts:s,isPromptsLoading:l})=>{nD(e);var d=D("chat_panels");return i(tn,{isOpen:e,onClose:t,children:n(b,{onError:()=>d(),errorRenderer:(e,a)=>i(nO,{error:e,errorInfo:a,onCloseChat:t}),children:[i(tr,{onSelectThread:a,initialUserMessage:o,onClose:t,prompts:s,isPromptsLoading:l,onHasResponse:r}),i(nL,{})]})})};return[()=>{as=N({header:{openThreadsPanelButtonAriaLabel:"Open session history",createNewThreadButtonAriaLabel:"Start a new session",closeButtonAriaLabel:"Minimize AI assistant",title:"Ask Ollie"},input:{cancelAriaLabel:"Cancel this message",sendAriaLabel:"Send message",inputAriaLabel:"How can I help you plan?",inputPlaceholder:"How can I help you plan?",entrypointInputAriaLabel:"Ask Ollie about {location}",entrypointInputShortAriaLabel:"Ask Ollie",entrypointInputPlaceholder:"Ask Ollie about {location}",entrypointInputShortPlaceholder:"Ask Ollie"}}),al=s(function({autoFocus:e,isLoading:a,onSubmitMessage:t,showCancelPendingButton:r,onCancelPendingMessage:o,disabled:s,updateInputSize:c,inputHasMultipleLines:u},h){var[m,p]=l("");d(()=>{e&&"function"!=typeof h&&h?.current&&h.current.focus()},[e,h]);var g=r||!m.trim()||a||s,f=()=>{g||(t(m),p(""),setTimeout(c,0))};return e7("resize",c),n("div",{className:E("VStPm Gi u _s",{CLHbi:u}),children:[i("div",{className:"SOCVR H",children:i(G,{atlasVariant:"fixed-body-30",children:i("textarea",{ref:h,value:m,onChange:e=>{p(e.target.value),c()},onKeyDown:e=>{var a=e.metaKey||e.ctrlKey||e.shiftKey||e.altKey;"Enter"!==e.key||a||(e.stopPropagation(),e.preventDefault(),g||f())},onFocus:c,"aria-label":as.input.inputAriaLabel,placeholder:as.input.inputPlaceholder,className:"HkODd w Gi Cj Q",rows:1,maxLength:500,disabled:s,...ef("aitaFreeTextInput")})})}),i("div",{className:"kwnBj",children:r?i(q,{"aria-label":as.input.cancelAriaLabel,type:"button",variant:"dark",size:"medium",icon:e9,onClick:()=>{o?.(),e&&"function"!=typeof h&&h?.current&&h.current.focus()},disabled:a||s,...ef("aitaCancelPendingMessageButton")}):i(q,{"aria-label":as.input.sendAriaLabel,type:"button",variant:"dark",size:"medium",icon:e3,onClick:f,disabled:g,...ef("aitaSendMessageButton")})})]})}),ad=m(void 0),ac=to,au=ts,ah=tp,am=tf,ap=tT,ag=tE,af=s(function({isLoading:e,onSubmitMessage:a,showCancelPendingButton:t,onCancelPendingMessage:r,disabled:o,updateInputSize:s,inputHasMultipleLines:d},c){var[u,h]=l(""),m=t||!u.trim()||e||o,p=()=>{m||(a(u),h(""),setTimeout(s,0))};return e7("resize",s),n("div",{className:E("myYJu u",{AhfWo:d}),children:[i("div",{className:"zexyc",children:i(e6,{size:20})}),i("div",{className:"H",children:i(G,{atlasVariant:"fixed-body-30",children:i("textarea",{ref:c,value:u,onChange:e=>{h(e.target.value),s()},onKeyDown:e=>{var a=e.metaKey||e.ctrlKey||e.shiftKey||e.altKey;"Enter"!==e.key||a||(e.stopPropagation(),e.preventDefault(),m||p())},onFocus:s,"aria-label":as.input.inputAriaLabel,placeholder:as.input.inputPlaceholder,className:"ZhAEz w Gz Cj B- Q",rows:1,maxLength:500,disabled:o,...ef("aitaFreeTextInput")})})}),i("div",{className:"RsZpl",children:t?i(q,{"aria-label":as.input.cancelAriaLabel,type:"button",variant:"dark",size:"small",icon:e9,onClick:()=>{r?.(),"function"!=typeof c&&c?.current&&c.current.focus()},disabled:e||o,...ef("aitaCancelPendingMessageButton")}):i(q,{"aria-label":as.input.sendAriaLabel,type:"button",variant:"dark",size:"small",icon:e3,onClick:p,disabled:m,...ef("aitaSendMessageButton")})})]})}),av=N({ariaPromptsList:"Examples of questions you can ask the AI assistant about this place",errorBoundaryTitle:"Oops!",header:"Need guidance? Ask Ollie.",errorBoundaryBody:"Something went wrong. Try closing the assistant and try again later."}),aT=m({openToast(){throw Error("Missing 'openToast' in ChatPanelsToastContext")}}),ab=tC,aE=N({header:{closeButtonAriaLabel:"Minimize AI assistant"},chat:{welcomeMessage:"I'm Ollie, your AI travel companion! I scan English-language reviews, forum posts, and recommendations for wisdom that'll help your trip take flight. Some questions you can ask me:",welcomeHeading:"Hello! \uD83D\uDC4B ",canceledMessage:"Your message was canceled—I didn’t see a thing! \uD83E\uDEE3",canceledMessageError:"I couldn’t cancel that message, sorry about that.",errorMessages:["Seems like I ran into a bit of a hiccup—sorry about that! Mind asking your question again?","Oops—I got a little tangled up looking for your answer. Can you repeat it for me?","I got a little mixed up looking for your answer—sorry! Want to try again? I'm right here when you're ready.","Whelp, I think there's a problem on my end—my mistake. Can you ask your question again?","Uh oh...flew a little too fast and hit a snag on my search. Can you ask me one more time?","Whoops! Looks like I hit a bit of turbulence fetching an answer. Try asking it again."],sourcesErrorBody:"Got a little mixed up while grabbing content for you—sorry!",sourcesErrorCta:"Try again",showSources:"Show sources",showSource:"Show source",hideSources:"Hide sources",hideSource:"Hide source",seeFullForumPost:"See full forum post",loadingInitialResponse:"Hang tight while I dive into our traveler recommendations and reviews...",ariaLoadingResponse:"The AI assistant is generating a response",ariaPromptsList:"Examples of questions you can ask the AI assistant about this place",moreMessagesErrorBody:"There was a problem retrieving older messages.",moreMessagesErrorCta:"Try again",retrySendMessageCta:"Try again",map:"Map",list:"List",scrollDown:"Scroll down"},threads:{title:"Previous sessions",newThread:"Start a new session",today:"Today",yesterday:"Yesterday",lastWeek:"Last Week",lastMonth:"Last Month",older:"Older",sessionDeleted:"Session deleted. Items saved to Trips are still available.",sessionDeletedError:"Session was not deleted. Please try again.",deleteSessionButtonAriaLabel:e=>`Delete session titled ${e}`,closeButtonAriaLabel:"Close session history",moreThreadsErrorTitle:"Oops!",moreThreadsErrorBody:"There was a problem retrieving older chats.",moreThreadsErrorCta:"Try again"},panel:{errorBody:"Got a little mixed up while grabbing content for you—sorry! ",errorCta:"Let’s try that again"},feedback:{voteThumbsUpAriaLabel:"Give this response a thumbs up",voteThumbsDownAriaLabel:"Give this response a thumbs down",votedThumbsUpAriaLabel:"You gave this response a thumbs up",votedThumbsDownAriaLabel:"You gave this response a thumbs down",closeAriaLabel:"Close feedback form",thumbsDownTitle:"What was the primary issue with this response?",thanksGood:"Thanks for your feedback!",thanksBad:"Thanks. Your feedback is valuable as we continue to improve our responses.",submitButton:"Submit",inputAriaLabel:"Add your comments",feedbackPlaceholder:"Add your comments",error:"Something went wrong while submitting your feedback. Please try again.",options:{NOT_FACTUAL:"Factually incorrect",LOW_QUALITY:"Low-quality recommendation",MISSING_DETAILS:"Missing key details",REFUSE_TO_ANSWER:"Refused to respond",ERROR:"Error or bug",INAPPROPRIATE:"Inappropriate",OTHER:"Other"}}}),ay=N([244,283,635,636]),aI=k.message,aC=aE.feedback.options,aN=tK,a_=tq,aS=tU,aM=tZ,ak=k.source,aR=tJ,aP=rt,aA=ro,aw=s(function({location:e,locationReviewSummary:a,onSaveClick:t,onSaveComplete:r,onNameLinkClick:s,tagsInfo:l},d){if(!e)return null;e.isGeo||a?.responseData?.rating==null||a?.responseData?.count==null||(c={rating:a.responseData.rating,reviewCount:a.responseData.count});var c,u=n(o,{children:[i("div",{className:rb.imageContainer,children:i(eD,{roundingSize:"none",action:i(U,{id:e.locationId||void 0,variant:"primary",bookmarkStyle:"circular-button",size:"small",saveSourceOrigin:"AI_TRAVEL_ASSISTANT",onClick:t,onSaveComplete:r}),award:e.locationV2?.bestAwardForActiveYearV2?.awardType&&i(eO,{size:"small",color:e.locationV2?.bestAwardForActiveYearV2?.awardType==="BOTB"?"yellow":"green",year:e.locationV2?.bestAwardForActiveYearV2?.year??void 0}),children:i(eL,{source:e.thumbnail?.photoSizeDynamic,aspectRatio:"1:1",roundingSize:"none"})})}),n("div",{className:rb.info,children:[i(G,{lineClamp:1,atlasVariant:"fixed-title-10",color:"onSurface",children:e.name}),c?i(ev,{size:"small",showRating:!1,rating:c.rating,reviewCount:c.reviewCount}):null,i(rm,{location:e,tagsInfo:l})]})]});return i("div",{className:rb.container,ref:d,children:e.route?.url?i("a",{href:e.route?.url,target:"_blank","aria-label":e.name||void 0,className:rb.card,onClick:s,children:u}):i("div",{className:rb.card,children:u})})}),aL=s(function({index:e,threadId:a,messageId:t,location:r,locationReviewSummary:n,tagsInfo:o},s){var l=Q(),d=r?.locationId,c={itemType:"aitaLocationCard",threadId:a,messageId:t,itemId:`${d}`,isBookableAttractionProduct:r?.locationV2?.details?.__typename==="LocationSelection_AttractionProductDetails"&&r?.locationV2?.details?.productDetails?.pricingInfo!=null,viewType:"MAP"},u=A({...c,saveable:!0}),h=R();return i("div",{ref:u,children:i(aw,{ref:s,location:r,locationReviewSummary:n,onSaveClick:()=>{h({...c,actionSubType:"clickSaveButton"})},onSaveComplete:(e,a,t)=>{h({...c,actionSubType:"saveLocationToTrip",tripId:t,tripSaveType:a}),L(l)},onNameLinkClick:()=>h({...c,actionSubType:"openLocationDetails",mapScrollDepth:e}),tagsInfo:o})})}),aO=ry,aD=rI,aB=g(rM),aQ=N({top:50,bottom:200,left:50,right:50}),az=rP,ax=rW,aH=rV,aW=rq,aV=r9,aK=new T({counterName:"aita_settled_assistant_messages",metricName:"EKo+nCQzQkK3QA4lB9jcWaTfYEqihHNA6+sWblM0TfMsBjIrNTP4r5BEJAs0VsuLUnNcQdwhjILfFMlgHmuM58+xn2VyWCLzsaeHqyRe7Wc=",version:0,additionalLabels:["EKo+nCQzQkK3QA4lB9jcWaTfYEqihHNA6+sWblM0TfPxmZLu0jLhWLMWnbfGiORfzkrzP74zL0vyAgCO1NCdfQ9Tc475vtE/NazR07eMROg="],labelHooks:[]},{status:["SEND_NETWORK_ERROR","SEND_INVALID_RESPONSE","SEND_EMPTY_RESPONSE","SEND_GRAPHQL_ERROR","SEND_TIMEOUT","SEND_SERVER_ERROR","SEND_SERVER_TIMEOUT","ANOTHER_PROMPT_PENDING","INAPPROPRIATE_PROMPT","CANCELED","POLL_NETWORK_ERROR","POLL_INVALID_RESPONSE","POLL_EMPTY_RESPONSE","POLL_GRAPHQL_ERROR","POLL_TIMEOUT","POLL_SERVER_ERROR","POLL_SERVER_TIMEOUT","COMPLETE"],hasLatency:["yes","no"],package:["@ta/ai-travel-assistant.panel"]}),aq=new T({counterName:"aita_settled_assistant_messages_latency",metricName:"EKo+nCQzQkK3QA4lB9jcWaTfYEqihHNA6+sWblM0TfM4geQOE77ZFE1XgCknxHf/ttXQE9ORcW8cCRbpzdoLKg==",version:0,additionalLabels:["EKo+nCQzQkK3QA4lB9jcWaTfYEqihHNA6+sWblM0TfM6bgh9aLdhPHrXgfSxTCnyNHKqS+laxZiJHQ+fz7KkbtoiqUiHsobyFt0F4GGVwUY="],labelHooks:[]},{status:["SEND_NETWORK_ERROR","SEND_INVALID_RESPONSE","SEND_EMPTY_RESPONSE","SEND_GRAPHQL_ERROR","SEND_TIMEOUT","SEND_SERVER_ERROR","SEND_SERVER_TIMEOUT","ANOTHER_PROMPT_PENDING","INAPPROPRIATE_PROMPT","CANCELED","POLL_NETWORK_ERROR","POLL_INVALID_RESPONSE","POLL_EMPTY_RESPONSE","POLL_GRAPHQL_ERROR","POLL_TIMEOUT","POLL_SERVER_ERROR","POLL_SERVER_TIMEOUT","COMPLETE"],package:["@ta/ai-travel-assistant.panel"]}),aY=N({CANCELED:"EKo+nCQzQkK3QA4lB9jcWaTfYEqihHNA6+sWblM0TfNuYgVFD0vwpxNxBDvY9JjqCdfZmHIBk+Qz4C5Fu2JTGw==",COMPLETE:"EKo+nCQzQkK3QA4lB9jcWaTfYEqihHNA6+sWblM0TfMZ+Fb2B+qz943QVCT0feyX1qVrYhs/lUMOfI/ZmwWjnw==",INAPPROPRIATE_PROMPT:"EKo+nCQzQkK3QA4lB9jcWaTfYEqihHNA6+sWblM0TfPF9kphaQ2wKDwGam8WBKicetTQLjYaS7Ltak5oTLJsjg==",SEND_NETWORK_ERROR:"EKo+nCQzQkK3QA4lB9jcWaTfYEqihHNA6+sWblM0TfPo7QTLDkC22NMQGm2arByZiiXF3XtuyW9BNIwXNEQ1GQ==",SEND_INVALID_RESPONSE:"EKo+nCQzQkK3QA4lB9jcWaTfYEqihHNA6+sWblM0TfMzknTUORgKNkFSVmA6be/YFI0N7D+zPmtfJPKWa4hQEg==",SEND_EMPTY_RESPONSE:"EKo+nCQzQkK3QA4lB9jcWaTfYEqihHNA6+sWblM0TfMi06pJTRiUVdgwYjN/sN0BUCkhOqpDA7pQchPwg5cACw==",SEND_GRAPHQL_ERROR:"EKo+nCQzQkK3QA4lB9jcWaTfYEqihHNA6+sWblM0TfNnpm1u4F02i9/fwjPgOsWTrXJy0rYWmMpQUFNyRPuhCw==",SEND_TIMEOUT:"EKo+nCQzQkK3QA4lB9jcWaTfYEqihHNA6+sWblM0TfOi896zijPg/tNKbH4v/RhJCyzRIW3cdIow+FSrtA8oCA==",SEND_SERVER_ERROR:"EKo+nCQzQkK3QA4lB9jcWaTfYEqihHNA6+sWblM0TfN9q+OhE5qVNNRyt100X4yhLolrAOkQn7iJn0YK4NAWAQ==",SEND_SERVER_TIMEOUT:"EKo+nCQzQkK3QA4lB9jcWaTfYEqihHNA6+sWblM0TfN9q+OhE5qVNNRyt100X4yhBxY7WEVbmf0z71v1hxpiPA==",ANOTHER_PROMPT_PENDING:"EKo+nCQzQkK3QA4lB9jcWaTfYEqihHNA6+sWblM0TfPCNTYWzirITkmR00fIFh8v47k5I2pkTncKM0HIR+Jo3A==",POLL_NETWORK_ERROR:"EKo+nCQzQkK3QA4lB9jcWaTfYEqihHNA6+sWblM0TfPcdCrH+GupkAHMNsjCyXBRA7zpHa/gA9ik0vKzgqC7bw==",POLL_INVALID_RESPONSE:"EKo+nCQzQkK3QA4lB9jcWaTfYEqihHNA6+sWblM0TfM24HZ9ETPTckzdVak33nyQ/ZT3+ceVjS1HRh8YDyt89A==",POLL_EMPTY_RESPONSE:"EKo+nCQzQkK3QA4lB9jcWaTfYEqihHNA6+sWblM0TfMZ/6A8nFeV9BPOoIPNgWPqa89mwmzWpAWSz9MjVpvOZw==",POLL_GRAPHQL_ERROR:"EKo+nCQzQkK3QA4lB9jcWaTfYEqihHNA6+sWblM0TfPrBsP7gR51bjvFez96bwzPXtldXAO4FMaefz9Buci3Nw==",POLL_TIMEOUT:"EKo+nCQzQkK3QA4lB9jcWaTfYEqihHNA6+sWblM0TfMF08RXxUirJCKe4d6fGA/CXewAUHaucWsw87k4hPvBlA==",POLL_SERVER_ERROR:"EKo+nCQzQkK3QA4lB9jcWaTfYEqihHNA6+sWblM0TfMpIt6xP7u2l2WK4BBvM0AbcFLJRGIGm724NhrrISOQhg==",POLL_SERVER_TIMEOUT:"EKo+nCQzQkK3QA4lB9jcWaTfYEqihHNA6+sWblM0TfMpIt6xP7u2l2WK4BBvM0AbfcFYtgWu+llpAvt1FkXjhw=="}),aG=ne,aj=N({sender:"agent",id:na,rawHeading:aE.chat.welcomeHeading,rawMessage:aE.chat.welcomeMessage}),aF=ni,aU=nc,aZ=v(()=>a("blyh4c")),aX=nu,aJ=nh,a$=nm,a0=s(function({onScroll:e,onScrollToBottomClick:a,children:t},r){var[o,s]=l(!0),d=u(a=>{a?.currentTarget?.scrollHeight-a?.currentTarget?.offsetHeight-a?.currentTarget?.scrollTop<=20?s(!0):s(!1),e?.()},[e]);return n("div",{className:"zexsO _T Gm z _g",ref:r,onScroll:d,children:[t,i(a$,{onClick:a,hideScrollButton:o})]})}),a1=s(function({prompts:e,onSubmitMessage:a,isLoading:t,showCancelPendingButton:r,onCancelPendingMessage:o,onScroll:s,onScrollToBottom:h,isNewConversation:m,children:p},g){var f=y(),v=c(null),T=function(e){var a=c(null),t=c(!1),{os:r}=e4(),n="IOS"===r.family;return d(()=>{var r,i,o=e.current,s=a.current;if(n&&o&&s){var l=e=>{if(!t.current&&window.visualViewport){e.preventDefault(),t.current=!0,s.focus({preventScroll:!0});var a=()=>{window.visualViewport&&window.innerHeight-window.visualViewport.height>100&&(r&&(clearTimeout(r),r=void 0),window.visualViewport?.removeEventListener("resize",a),i=void 0,o.focus({preventScroll:!0}),t.current=!1)};i=a,window.visualViewport?.addEventListener("resize",a),r=setTimeout(()=>{i&&(window.visualViewport?.removeEventListener("resize",i),i=void 0),o.focus({preventScroll:!0}),t.current=!1,r=void 0},500)}};return o.addEventListener("focus",l,!0),()=>{o.removeEventListener("focus",l,!0),r&&clearTimeout(r),i&&window.visualViewport?.removeEventListener("resize",i),t.current&&(t.current=!1)}}},[e,n]),a}(v),[b,E]=l(!1),I=u((e,t)=>{a({text:e.text,type:"PROMPT",origin:"MESSAGES_PANEL",promptType:e.type,promptScrollDepth:t})},[a]),C=u(()=>{if(v.current){var e=parseInt(getComputedStyle(v.current).lineHeight.replace("px",""),10),a=("MOBILE"===f?6:3)*e;v.current.style.height="0px";var{scrollHeight:t}=v.current;v.current.style.height=`${Math.min(0===t?e:t,a)}px`,E(t>e)}},[f]),N=u(()=>{h?.(),"DESKTOP"===f&&v?.current?.focus()},[h,f]);return n("div",{className:"LyyTR",children:[i("textarea",{ref:T,tabIndex:-1,"aria-hidden":"true",className:"XGwZj t l Y S"}),i(a0,{ref:g,onScroll:s,onScrollToBottomClick:N,children:n("div",{className:"GWZcH e",children:[p,m&&i(aJ,{prompts:e,onPromptClick:I})]})}),i("div",{className:"TvjzB s l w",children:i("div",{className:"FRJtu Pj PX Pw PJ",children:"MOBILE"===f?i(af,{ref:v,onSubmitMessage:e=>a({text:e,type:"FREE_TEXT",origin:"MESSAGES_PANEL"}),isLoading:t,showCancelPendingButton:r,onCancelPendingMessage:o,updateInputSize:C,inputHasMultipleLines:b}):i(al,{ref:v,autoFocus:"DESKTOP"===f,onSubmitMessage:e=>a({text:e,type:"FREE_TEXT",origin:"MESSAGES_PANEL"}),isLoading:t,showCancelPendingButton:r,onCancelPendingMessage:o,updateInputSize:C,inputHasMultipleLines:b})})})]})}),a2=ng,a4=s(function({messages:e,prompts:a,userAvatar:t,agentAvatar:r,onSubmitMessage:s,isLoading:l,showCancelPendingButton:d,onCancelPendingMessage:c,onScroll:u,onScrollToBottom:m,backgroundColors:p,onClose:g,onOpenThreadsPanel:f,createNewThread:v,pagedMessagesError:T,onTryLoadMore:b,threadId:E,tagsInfoMap:y,isMapViewExperimentEnabled:I},C){var N=h(()=>1===e.filter(e=>"user"===e.sender).length,[e]),_=h(()=>e.every(e=>"user"!==e.sender),[e]),S=h(()=>e.map(e=>{var a,t=[];if("user"===e.sender){var r=e?.responseData?.__typename==="TravelChatManager_UserMessage"?e.responseData.messageContent?.text:null,s=e.rawMessage??r;s&&t.push({type:"text",content:i(rj,{children:s})})}else{var l=[];if(e?.responseData?.__typename==="TravelChatManager_AssistantMessage"){var d=r2({threadId:e.responseData.threadId,messageId:e.responseData.messageId,status:e.responseData.status,content:e.responseData.content,resolvedGeoIds:e.responseData.resolvedGeoIds,feedbackRating:e.responseData.feedbackRating,isMapViewEnabled:I,tagsInfoMap:y});l=d.contents?[...d.contents]:l,a=e.responseData.intermediateThought??void 0}else e.isError?l.push(nf(e.refetch)):e.isCancel?l.push({content:i(rF,{})}):e.rawMessage&&l.push({content:n(o,{children:[e.rawHeading?i(G,{atlasVariant:"fixed-label-30",children:e.rawHeading}):null,i(rj,{children:e.rawMessage})]})});t.push(...l)}return{id:e.id,sender:e.sender,isPending:e.isPending,intermediateThought:a,contents:t}}),[y,e,I]);return n(a1,{ref:C,prompts:a,onSubmitMessage:s,isLoading:l,showCancelPendingButton:d,onCancelPendingMessage:c,onScroll:u,onScrollToBottom:m,isNewConversation:_,children:[i(ac,{onClose:g,onOpenThreadsPanel:f,createNewThread:v}),i(a2,{}),T&&i(ag,{errorBody:aE.chat.moreMessagesErrorBody,retry:b,retryButtonTitle:aE.chat.moreMessagesErrorCta}),S.map(e=>i(aX,{isFirstUserMessage:N,message:e,userAvatar:t,agentAvatar:r,backgroundColors:p,threadId:E},e.id))]})}),a3=nb,a6=nE,a9=ny,a7=N({today:aE.threads.today,yesterday:aE.threads.yesterday,lastWeek:aE.threads.lastWeek,lastMonth:aE.threads.lastMonth,older:aE.threads.older}),a5=s(function({selectedThreadId:e,threads:a,pagedThreadsError:t,onThreadClick:r,createNewThread:o,onDeleteThread:s,onTryLoadMore:l,onScroll:u,onClose:m},p){var g=c(null);d(()=>{g.current?.focus()},[]);var f=an(),v=h(()=>{var e=ai(f,-1),t=ai(e,-5),r=ai(t,-23),n={today:[],yesterday:[],lastWeek:[],lastMonth:[],older:[]};return a.forEach(a=>{a.updatedAt>=f?n.today.push(a):a.updatedAt>=e?n.yesterday.push(a):a.updatedAt>=t?n.lastWeek.push(a):a.updatedAt>=r?n.lastMonth.push(a):n.older.push(a)}),n},[a,f]);return n("div",{className:nI.threadPanel,children:[i(nC,{onClose:m}),i("div",{className:E(nI.newChatContainer,nI.horizontalMargins),children:n("button",{ref:g,onClick:o,type:"button",className:E(nI.resetButtonStyles,nI.newThreadButton),...ef("aitaStartNewSession"),children:[i(ar,{size:24}),i(G,{elementType:"span",atlasVariant:"fixed-label-30",children:aE.threads.newThread})]})}),n("div",{className:E(nI.threadPanelScroll,nI.horizontalMargins),ref:p,onScroll:u,children:[Object.keys(a7).map(a=>v[a].length>0&&n("div",{className:nI.threadsGroup,...ef("aitaHistoryCategory"),children:[n("div",{className:nI.threadsGroupHeader,children:[i(G,{atlasVariant:"fixed-label-30",color:"onSurfaceVariant",elementType:"h3",children:a7[a]}),i("div",{"aria-hidden":!0,children:i(eZ,{marginTop:"spacing-01",marginBottom:"spacing-01"})})]}),v[a].map(a=>i(a9,{isSelected:a.threadId===e,threadId:a.threadId,title:a.title,onThreadClick:r,onDeleteThread:s},a.threadId))]},a)),t&&i(ag,{errorTitle:aE.threads.moreThreadsErrorTitle,errorBody:aE.threads.moreThreadsErrorBody,retry:l,retryButtonTitle:aE.threads.moreThreadsErrorCta})]})]})}),a8=nN,te=n_,ta=nS,tt=nM,tr=nR,tn=nA,ti=new T({counterName:"aita_chat_render",metricName:"rxoX9PgJuydBH0GlcDMrIE0ckPAO4PpNcR5whsCgLQna55TmUC4wfTJxG+Emd/iX",version:0,additionalLabels:["rxoX9PgJuydBH0GlcDMrIHxogDvZKDvO95C6YghmCcg/uDcEH+oqiAmDB4bX4U1QKdikDf5Bk57zyePqncirRQ=="],labelHooks:[]},{status:["ok","error"],package:["@ta/ai-travel-assistant.entrypoint"]}),e("default",nB)},[e=>(n=e.jsxs,i=e.jsx,o=e.Fragment),e=>(s=e.forwardRef,l=e.useState,d=e.useEffect,c=e.useRef,u=e.useCallback,h=e.useMemo,m=e.createContext,p=e.useContext,g=e.memo,f=e.Suspense,v=e.lazy),e=>(T=e.Counter,b=e.ErrorBoundary),e=>E=e.default,e=>y=e.useViewportCategory,e=>I=e.ModalBase,e=>C=e.default,e=>N=e.readOnly,e=>(_=e.u,S=e.S,M=e.a,k=e.b,R=e.c,P=e.d,A=e.e,w=e.f,L=e.o,O=e.E,D=e.g),e=>B=e.default,e=>Q=e.useUserId,e=>z=e.default,e=>x=e.default,e=>H=e.default,e=>W=e.default,e=>V=e.ToastItem,e=>(K=e.default,q=e.CircularButton,Y=e.ButtonBorderless),e=>G=e.default,e=>j=e.default,e=>F=e.default,e=>U=e.default,e=>(Z=e.useQuery,X=e.useMutation),e=>(J=e.default,$=e.useRtl,ee=e.useLocalize,ea=e.useCurrency,et=e.useIntlFormatter,er=e.UnsafeLocalize),e=>en=e.default,e=>ei=e.default,e=>eo=e.default,e=>(es=e.RadioGroup,el=e.RadioButton),e=>ed=e.TextArea,e=>ec=e.default,e=>eu=e.default,e=>eh=e.Spinner,e=>em=e.default,e=>ep=e.default,e=>eg=e.default,e=>ef=e.getQAAttributes,e=>ev=e.BubbleRating,e=>eT=e.default,e=>eb=e.default,e=>eE=e.default,e=>ey=e.default,e=>eI=e.default,e=>eC=e.default,e=>eN=e.default,e=>(e_=e.LatLng,eS=e.LatLngBounds,eM=e.Util),e=>(ek=e.useMarkerRegistryContext,eR=e.CollapsibleIconPinMarker,eP=e.MarkerRegistryContextProvider),e=>eA=e.MapComponent,e=>ew=e.debounce,e=>eL=e.default,e=>eO=e.default,e=>eD=e.CardMedia,e=>eB=e.default,e=>eQ=e.IconDetail,e=>ez=e.default,e=>(ex=e.default,eH=e.lineClamp,eW=e.padding),e=>eV=e.default,e=>eK=e.getPrimaryTag,e=>eq=e.default,e=>eY=e.useInvalidatableQuery,e=>eG=e.default,e=>ej=e.default,e=>eF=e.default,e=>eU=e.default,e=>eZ=e.default,e=>eX=e.Skeleton,e=>eJ=e.useClientSideLayoutEffect,e=>e$=e.useIconSvgAttributes,e=>(e0=e.default,e1=e.useAbTestWithQueryStatus),e=>e2=e.default,e=>e4=e.useUserAgent,e=>e3=e.default,e=>e6=e.default,e=>e9=e.default,e=>e7=e.useWindow,e=>e5=e.useGetServiceLink,e=>e8=e.default,e=>ae=e.default,e=>aa=e.default,e=>at=e.FocusTrap,e=>ar=e.default,e=>(an=e.useToday,ai=e.addDays),e=>ao=e.default]]},["21h32l","o4yt4q","83pm0d","fkji80","ys6v1o","uzmmz7","sdpjgr","5vmpsm","nv7v96","rdycz1","52far5","kq4q2w","gcjubj","w43m8k","u47wjb","nntg4s","jppfwt","essqvy","y9enps","lr6tb6","dpzonz","mqwhqn","7thqz4","n4zdla","wehxiu","qkjm8h","frf6ac","tv5det","i0z8n1","4ilds0","qndsds","633gr8","u3wokd","kt39pq","j77a03","trf9tg","0wbf8p","a6i9w3","6qmqhw","7nq86i","7a7jm3","6h4i0r","us1vwl","jgmezl","49c7br","5xqg72","dsbyen","34bu7w","p9ucm8","f1x7n0","bp96i9","70j2tf","o3mm96","gw8uw6","p3y1zq","xfufl0","ph948p","fbuhsy","9zpurr","xp34yw","o80y56","dcz41w","covaqn","voa3hw","mb2nze","q213pt","0a0jsz","h9085v","nnprhg","obrjv3","qx89h8","pts58q","ltllz9","epp8eq","ypf49l","rctp90","ac38c0","2r4qug","ti102j","kb5au4","d3i8k1"]]);
